<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GATE Rank Predictor 2026 ðŸŽ¯ | Accurate Rank & IIT Chances</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body {
            background: var(--gradient);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            width: 95%;
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* Compact Header */
        .compact-header {
            background: linear-gradient(135deg, var(--primary) 0%, #1a2530 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .compact-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(52, 152, 219, 0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: 0;
        }

        .logo-compact {
            display: inline-flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
        }

        .logo-compact i {
            font-size: 2rem;
            color: var(--secondary);
            background: white;
            padding: 8px;
            border-radius: 50%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .logo-compact h1 {
            font-size: 1.8rem;
            font-weight: 800;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .tagline {
            font-size: 0.95rem;
            opacity: 0.9;
            color: #ecf0f1;
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tagline span {
            background: rgba(52, 152, 219, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
        }

        /* Main Content */
        .main-content {
            padding: 25px;
        }

        /* Compact Input Section */
        .input-section-compact {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 2px solid #e0e0e0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 1.4rem;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(52, 152, 219, 0.2);
        }

        .section-title i {
            color: var(--secondary);
        }

        .compact-input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .compact-input-grid {
                grid-template-columns: 1fr;
            }
        }

        .paper-selector {
            grid-column: 1 / -1;
        }

        .input-group-compact {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group-compact label {
            font-weight: 700;
            color: #555;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .input-group-compact input, .input-group-compact select {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }

        .input-group-compact input:focus, .input-group-compact select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            transform: translateY(-2px);
        }

        /* Marks Input Groups */
        .marks-input-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .input-with-label {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-label {
            font-weight: 600;
            color: #555;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .input-label .max-limit {
            font-size: 0.8rem;
            color: #777;
            font-weight: normal;
        }

        .marks-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
        }

        .marks-input:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        .marks-input.invalid {
            border-color: var(--danger);
            background-color: rgba(231, 76, 60, 0.05);
        }

        .error-message {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        /* Category Buttons */
        .category-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        @media (max-width: 600px) {
            .category-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .category-btn {
            padding: 12px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
        }

        .category-btn:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
        }

        .category-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        /* Category Benefits Info */
        .category-info {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.1), rgba(52, 152, 219, 0.05));
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid var(--secondary);
            font-size: 0.9rem;
            display: none;
        }

        .category-info.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .category-info h4 {
            color: var(--primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-info p {
            margin-bottom: 5px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .predict-btn {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            color: white;
            border: none;
            padding: 16px 35px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .predict-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(52, 152, 219, 0.4);
        }

        .predict-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .predict-again-btn {
            background: linear-gradient(135deg, var(--warning), #e67e22);
            color: white;
            border: none;
            padding: 16px 35px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 20px rgba(243, 156, 18, 0.3);
            display: none;
        }

        .predict-again-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 30px rgba(243, 156, 18, 0.4);
        }

        /* Marks Preview */
        .marks-preview {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-top: 20px;
            border: 2px solid #e0e0e0;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            text-align: center;
        }

        .marks-preview-item {
            padding: 10px;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .marks-preview-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            margin: 5px 0;
        }

        .marks-preview-label {
            color: #666;
            font-size: 0.85rem;
            font-weight: 600;
        }

        /* Note Box */
        .note-box {
            background: linear-gradient(135deg, #fff8e1, #ffeaa7);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid var(--warning);
            font-size: 0.9rem;
        }

        .note-box i {
            color: var(--warning);
            margin-right: 8px;
        }

        /* Results Section */
        .results-section {
            display: none;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f0f0f0;
        }

        .results-header h2 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        /* Results Grid (Like Screenshot) */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }

        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        .result-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }

        .result-card.highlight {
            border-color: var(--secondary);
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(52, 152, 219, 0.15);
        }

        .result-card-title {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 10px;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .result-card-value {
            font-size: 3rem;
            font-weight: 800;
            margin: 10px 0;
            color: var(--primary);
            line-height: 1;
        }

        .result-card-description {
            font-size: 0.95rem;
            color: #777;
            margin-top: 5px;
        }

        .result-card-rank-range {
            font-size: 1.1rem;
            color: var(--secondary);
            font-weight: 700;
            margin-top: 10px;
            background: rgba(52, 152, 219, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
        }

        /* IIT Possibility Section */
        .iit-possibility {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.1), rgba(39, 174, 96, 0.05));
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid var(--success);
        }

        .iit-possibility h3 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }

        .iit-colleges {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .iit-colleges {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .iit-colleges {
                grid-template-columns: 1fr;
            }
        }

        .iit-college {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 2px solid #e0e0e0;
        }

        .iit-college.high {
            border-color: var(--success);
        }

        .iit-college.medium {
            border-color: var(--warning);
        }

        .iit-college.low {
            border-color: var(--danger);
        }

        .iit-college-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .iit-college-title {
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .iit-college-chance {
            font-size: 1.2rem;
            font-weight: 800;
            margin: 10px 0;
        }

        .iit-college-chance.high {
            color: var(--success);
        }

        .iit-college-chance.medium {
            color: var(--warning);
        }

        .iit-college-chance.low {
            color: var(--danger);
        }

        .iit-college-rank {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
        }

        /* Category-wise Performance */
        .category-performance {
            background: linear-gradient(135deg, rgba(155, 89, 182, 0.1), rgba(155, 89, 182, 0.05));
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid #9b59b6;
        }

        .category-performance h3 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        @media (max-width: 600px) {
            .category-stats {
                grid-template-columns: 1fr;
            }
        }

        .category-stat {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .category-stat-title {
            font-weight: 600;
            color: #666;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .category-stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin: 10px 0;
        }

        .category-stat-difference {
            font-size: 1rem;
            font-weight: 600;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
        }

        .positive {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .negative {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        /* PSU Chances Section */
        .psu-chances {
            background: linear-gradient(135deg, rgba(243, 156, 18, 0.1), rgba(243, 156, 18, 0.05));
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid var(--warning);
        }

        .psu-chances h3 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .psu-level {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.1rem;
            margin: 15px 0;
        }

        .psu-very-high {
            background-color: rgba(39, 174, 96, 0.2);
            color: var(--success);
            border: 2px solid var(--success);
        }

        .psu-high {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--secondary);
            border: 2px solid var(--secondary);
        }

        .psu-moderate {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning);
            border: 2px solid var(--warning);
        }

        .psu-low {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger);
            border: 2px solid var(--danger);
        }

        .psu-very-low {
            background-color: rgba(149, 165, 166, 0.2);
            color: #7f8c8d;
            border: 2px solid #95a5a6;
        }

        /* Scores Table */
        .scores-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .scores-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
        }

        .scores-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .scores-table tr:hover {
            background: #f9f9f9;
        }

        /* Graph Section */
        .graph-section {
            margin-top: 40px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #e0e0e0;
        }

        .graph-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .graph-header h3 {
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .graph-container {
            height: 350px;
            position: relative;
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .loading i {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 20px;
            animation: spin 1.5s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: linear-gradient(135deg, var(--primary) 0%, #1a2530 100%);
            color: white;
            padding: 40px;
            margin-top: 40px;
            text-align: center;
        }

        .footer-content h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: white;
        }

        .footer-content p {
            opacity: 0.9;
            margin-bottom: 25px;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin: 25px 0;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
        }

        .contact-item i {
            color: var(--secondary);
            font-size: 1.3rem;
        }

        .contact-email {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 25px;
            border-radius: 50px;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .contact-email:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }

        .copyright {
            opacity: 0.9;
            font-size: 1rem;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                width: 98%;
                border-radius: 15px;
            }

            .main-content {
                padding: 15px;
            }

            .logo-compact h1 {
                font-size: 1.5rem;
            }

            .compact-header {
                padding: 15px 20px;
            }

            .marks-preview {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .predict-btn, .predict-again-btn {
                padding: 14px 28px;
                font-size: 1.1rem;
                width: 100%;
                max-width: 300px;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .result-card-value {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 480px) {
            .category-buttons {
                grid-template-columns: 1fr;
            }

            .marks-input-group {
                grid-template-columns: 1fr;
            }

            .result-card-value {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Compact Header -->
        <header class="compact-header">
            <div class="logo-compact">
                <i class="fas fa-graduation-cap"></i>
                <h1>GATE Rank Predictor 2026</h1>
            </div>
            <p class="tagline">
                <span>Category-wise Predictions</span> 
                <span>IIT Admission Chances</span>
                <span>PSU Eligibility</span>
            </p>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Compact Input Section -->
            <div class="input-section-compact">
                <div class="section-title">
                    <i class="fas fa-edit"></i>
                    <h2>Enter Your GATE Details</h2>
                </div>
                
                <div class="compact-input-grid">
                    <!-- Paper Selection -->
                    <div class="paper-selector">
                        <div class="input-group-compact">
                            <label><i class="fas fa-file-alt"></i> Select Your Paper</label>
                            <select id="paper">
                                <option value="CE">Civil Engineering (CE)</option>
                                <option value="ME">Mechanical Engineering (ME)</option>
                                <option value="EE">Electrical Engineering (EE)</option>
                                <option value="EC">Electronics & Communication (EC)</option>
                                <option value="CS" selected>Computer Science (CS)</option>
                                <option value="IN">Instrumentation Engineering (IN)</option>
                                <option value="CH">Chemical Engineering (CH)</option>
                                <option value="PI">Production & Industrial (PI)</option>
                                <option value="XE">Engineering Sciences (XE)</option>
                                <option value="ES">Ecology & Evolution (ES)</option>
                                <option value="DA">Data Science & AI (DA)</option>
                            </select>
                        </div>
                    </div>

                    <!-- 1-Mark Questions -->
                    <div class="input-group-compact">
                        <label><i class="fas fa-1"></i> 1-Mark Questions</label>
                        <div class="marks-input-group">
                            <div class="input-with-label">
                                <div class="input-label">
                                    Correct Answers
                                    <span class="max-limit">Max: 30</span>
                                </div>
                                <input type="number" id="type1Correct" class="marks-input" min="0" max="30" step="1" value="15" oninput="validateInput('type1')">
                                <div class="error-message" id="type1Error"></div>
                            </div>
                            <div class="input-with-label">
                                <div class="input-label">
                                    Wrong Answers
                                    <span class="max-limit">Max: 30</span>
                                </div>
                                <input type="number" id="type1Wrong" class="marks-input" min="0" max="30" step="1" value="2" oninput="validateInput('type1')">
                                <div class="error-message" id="type1WrongError"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 2-Mark Questions -->
                    <div class="input-group-compact">
                        <label><i class="fas fa-2"></i> 2-Mark Questions</label>
                        <div class="marks-input-group">
                            <div class="input-with-label">
                                <div class="input-label">
                                    Correct Answers
                                    <span class="max-limit">Max: 35</span>
                                </div>
                                <input type="number" id="type2Correct" class="marks-input" min="0" max="35" step="1" value="10" oninput="validateInput('type2')">
                                <div class="error-message" id="type2Error"></div>
                            </div>
                            <div class="input-with-label">
                                <div class="input-label">
                                    Wrong Answers
                                    <span class="max-limit">Max: 35</span>
                                </div>
                                <input type="number" id="type2Wrong" class="marks-input" min="0" max="35" step="1" value="1" oninput="validateInput('type2')">
                                <div class="error-message" id="type2WrongError"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Category Selection -->
                    <div class="input-group-compact">
                        <label><i class="fas fa-users"></i> Select Your Category</label>
                        <div class="category-buttons">
                            <button class="category-btn active" onclick="selectCategory('GEN')">General</button>
                            <button class="category-btn" onclick="selectCategory('OBC')">OBC-NCL</button>
                            <button class="category-btn" onclick="selectCategory('EWS')">EWS</button>
                            <button class="category-btn" onclick="selectCategory('SC')">SC</button>
                            <button class="category-btn" onclick="selectCategory('ST')">ST</button>
                            <button class="category-btn" onclick="selectCategory('PWD')">PwD</button>
                        </div>
                        <input type="hidden" id="category" value="GEN">
                    </div>

                    <!-- Category Benefits Info -->
                    <div class="category-info" id="categoryInfo">
                        <h4><i class="fas fa-info-circle"></i> Category Benefits Information</h4>
                        <p id="categoryBenefitsText"></p>
                    </div>

                    <!-- Marks Preview -->
                    <div class="marks-preview">
                        <div class="marks-preview-item">
                            <div class="marks-preview-label">1-Mark Score</div>
                            <div class="marks-preview-value" id="type1Marks">0.00</div>
                        </div>
                        <div class="marks-preview-item">
                            <div class="marks-preview-label">2-Mark Score</div>
                            <div class="marks-preview-value" id="type2Marks">0.00</div>
                        </div>
                        <div class="marks-preview-item">
                            <div class="marks-preview-label">Total Marks</div>
                            <div class="marks-preview-value" id="totalMarks">0.00</div>
                        </div>
                    </div>

                    <!-- Note Box -->
                    <div class="note-box">
                        <p><i class="fas fa-info-circle"></i> <strong>Note:</strong> SC/ST categories have significant rank benefits. Students with lower marks (e.g., 45 marks) can get much better ranks in reserved categories compared to General category.</p>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <button class="predict-btn" id="predictBtn" onclick="predictRank()">
                    <i class="fas fa-bolt"></i> 
                    PREDICT MY RANK & IIT CHANCES
                </button>
                <button class="predict-again-btn" id="predictAgainBtn" onclick="resetForm()">
                    <i class="fas fa-redo"></i> 
                    PREDICT AGAIN
                </button>
            </div>

            <!-- Loading Animation -->
            <div class="loading" id="loading">
                <i class="fas fa-spinner"></i>
                <p>Analyzing your marks and category benefits...</p>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <div class="results-header">
                    <h2><i class="fas fa-chart-line"></i> Your Prediction Results</h2>
                    <p>Based on GATE 2025 data with category-wise adjustments</p>
                </div>

                <!-- Results Grid (Like Screenshot) -->
                <div class="results-grid">
                    <div class="result-card highlight">
                        <div class="result-card-title">
                            <i class="fas fa-trophy"></i>
                            Expected Rank
                        </div>
                        <div class="result-card-value" id="predictedRank">0</div>
                        <div class="result-card-description">All India Rank</div>
                        <div class="result-card-rank-range" id="rankRange">0 - 0</div>
                    </div>

                    <div class="result-card">
                        <div class="result-card-title">
                            <i class="fas fa-star"></i>
                            GATE Score
                        </div>
                        <div class="result-card-value" id="gateScore">0</div>
                        <div class="result-card-description">Out of 1000</div>
                    </div>

                    <div class="result-card">
                        <div class="result-card-title">
                            <i class="fas fa-chart-pie"></i>
                            Percentile
                        </div>
                        <div class="result-card-value" id="percentile">0%</div>
                        <div class="result-card-description">Approximate</div>
                    </div>

                    <div class="result-card">
                        <div class="result-card-title">
                            <i class="fas fa-bullseye"></i>
                            Rank Range
                        </div>
                        <div class="result-card-value" id="rankRangeValue">0</div>
                        <div class="result-card-description">Â±15% variation</div>
                        <div class="result-card-rank-range" id="rankRangeDisplay">0 - 0</div>
                    </div>
                </div>

                <!-- Category-wise Performance -->
                <div class="category-performance" id="categoryPerformance">
                    <h3><i class="fas fa-users"></i> Category-wise Performance Analysis</h3>
                    <div class="category-stats" id="categoryStats">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- IIT Possibility Section -->
                <div class="iit-possibility" id="iitPossibility">
                    <h3><i class="fas fa-university"></i> IIT Admission Possibility</h3>
                    <p>Based on your predicted rank and category</p>
                    <div class="iit-colleges" id="iitColleges">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- PSU Chances Section -->
                <div class="psu-chances" id="psuDetails">
                    <h3><i class="fas fa-briefcase"></i> PSU Recruitment Chances</h3>
                    <div class="psu-level" id="psuLevel">Very High</div>
                    <p id="psuDescription"></p>
                    <p><em>Note: PSU selection depends on category, vacancies, and interview performance.</em></p>
                </div>

                <!-- Scores Table -->
                <div style="margin: 30px 0;">
                    <h4 style="color: var(--primary); margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-chart-bar"></i> Category-wise Expected Cutoff 2026
                    </h4>
                    <table class="scores-table">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Expected Cutoff Range</th>
                                <th>Your Marks</th>
                                <th>Status</th>
                                <th>Rank Equivalent</th>
                            </tr>
                        </thead>
                        <tbody id="scoresTableBody">
                            <!-- Will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>

                <!-- Graph Section -->
                <div class="graph-section">
                    <div class="graph-header">
                        <h3><i class="fas fa-chart-line"></i> Category-wise Rank Comparison</h3>
                        <p>Your rank across different categories</p>
                    </div>
                    <div class="graph-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <h3>GATE Rank Predictor 2026</h3>
                <p>Accurate predictions with category-specific IIT admission analysis</p>
                
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <div>
                            <p>Contact for Queries & Suggestions</p>
                            <a href="mailto:bituraj036@gmail.com" class="contact-email">
                                bituraj036@gmail.com
                            </a>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-info-circle"></i>
                        <p>Need help? Email us for support</p>
                    </div>
                </div>
                
                <div class="copyright">
                    <i class="fas fa-copyright"></i> 2025 GATE Rank Predictor | Created by Bitu Raj
                </div>
            </div>
        </footer>
    </div>

    <script>
        // GATE 2025 Data for CS (kept intact)
        const gateCS2025Data = [
            { rank: 1, score: 1000, marks: 100.00 },
            { rank: 4, score: 985, marks: 91.64 },
            { rank: 8, score: 976, marks: 90.75 },
            { rank: 12, score: 959, marks: 89.04 },
            { rank: 14, score: 956, marks: 88.71 },
            { rank: 32, score: 929, marks: 86.11 },
            { rank: 38, score: 922, marks: 85.43 },
            { rank: 58, score: 906, marks: 83.84 },
            { rank: 65, score: 903, marks: 83.51 },
            { rank: 130, score: 860, marks: 79.29 },
            { rank: 215, score: 833, marks: 76.69 },
            { rank: 306, score: 810, marks: 73.57 },
            { rank: 308, score: 810, marks: 74.38 },
            { rank: 336, score: 802, marks: 73.57 },
            { rank: 351, score: 797, marks: 73.16 },
            { rank: 365, score: 797, marks: 73.11 },
            { rank: 416, score: 785, marks: 71.93 },
            { rank: 532, score: 767, marks: 70.20 },
            { rank: 609, score: 757, marks: 69.21 },
            { rank: 622, score: 756, marks: 69.07 },
            { rank: 724, score: 744, marks: 67.91 },
            { rank: 1121, score: 711, marks: 64.66 },
            { rank: 1171, score: 708, marks: 64.34 },
            { rank: 1414, score: 689, marks: 62.52 },
            { rank: 1445, score: 688, marks: 62.39 },
            { rank: 1605, score: 649, marks: 58.47 },
            { rank: 2434, score: 632, marks: 56.87 },
            { rank: 2498, score: 628, marks: 56.54 },
            { rank: 3466, score: 589, marks: 52.70 },
            { rank: 4135, score: 568, marks: 50.65 },
            { rank: 5620, score: 529, marks: 46.79 },
            { rank: 6600, score: 506, marks: 44.52 },
            { rank: 9288, score: 460, marks: 40.02 },
            { rank: 11184, score: 436, marks: 37.69 },
            { rank: 11318, score: 435, marks: 37.56 },
            { rank: 11517, score: 433, marks: 37.37 },
            { rank: 12652, score: 420, marks: 36.07 },
            { rank: 14720, score: 400, marks: 34.12 },
            { rank: 18757, score: 368, marks: 31.01 },
            { rank: 19661, score: 364, marks: 30.54 },
            { rank: 23003, score: 343, marks: 28.56 }
        ];

        // Category Multipliers (Rank Improvement Factors)
        const categoryMultipliers = {
            'GEN': 1.0,    // Base
            'OBC': 1.5,    // 50% better rank
            'EWS': 1.5,    // 50% better rank
            'SC': 2.5,     // 150% better rank (45 marks in SC = much better rank)
            'ST': 3.0,     // 200% better rank (45 marks in ST = excellent rank)
            'PWD': 2.0     // 100% better rank
        };

        // Category Benefits Information
        const categoryBenefits = {
            'GEN': "General category has highest competition. Need higher marks for good rank.",
            'OBC': "OBC-NCL category has 27% reservation. Rank improvement factor: 1.5x",
            'EWS': "EWS category has 10% reservation. Rank improvement factor: 1.5x",
            'SC': "SC category has 15% reservation. Significant rank benefits with lower marks.",
            'ST': "ST category has 7.5% reservation. Best rank benefits among all categories.",
            'PWD': "PwD category has 5% horizontal reservation. Additional benefits across all categories."
        };

        // IIT Cutoff Ranks by Category
        const iitCutoffs = {
            'CS': {
                'GEN': { topIITs: 100, oldIITs: 500, newIITs: 1500 },
                'OBC': { topIITs: 200, oldIITs: 1000, newIITs: 3000 },
                'SC': { topIITs: 400, oldIITs: 2000, newIITs: 6000 },
                'ST': { topIITs: 600, oldIITs: 3000, newIITs: 8000 },
                'EWS': { topIITs: 200, oldIITs: 1000, newIITs: 3000 },
                'PWD': { topIITs: 400, oldIITs: 2000, newIITs: 6000 }
            },
            'CE': {
                'GEN': { topIITs: 150, oldIITs: 700, newIITs: 2000 },
                'OBC': { topIITs: 300, oldIITs: 1400, newIITs: 4000 },
                'SC': { topIITs: 600, oldIITs: 2800, newIITs: 8000 },
                'ST': { topIITs: 900, oldIITs: 4200, newIITs: 12000 }
            },
            'ME': {
                'GEN': { topIITs: 200, oldIITs: 800, newIITs: 2500 },
                'OBC': { topIITs: 400, oldIITs: 1600, newIITs: 5000 },
                'SC': { topIITs: 800, oldIITs: 3200, newIITs: 10000 },
                'ST': { topIITs: 1200, oldIITs: 4800, newIITs: 15000 }
            },
            'EE': {
                'GEN': { topIITs: 150, oldIITs: 600, newIITs: 1800 },
                'OBC': { topIITs: 300, oldIITs: 1200, newIITs: 3600 },
                'SC': { topIITs: 600, oldIITs: 2400, newIITs: 7200 },
                'ST': { topIITs: 900, oldIITs: 3600, newIITs: 10800 }
            },
            'EC': {
                'GEN': { topIITs: 120, oldIITs: 500, newIITs: 1500 },
                'OBC': { topIITs: 240, oldIITs: 1000, newIITs: 3000 },
                'SC': { topIITs: 480, oldIITs: 2000, newIITs: 6000 },
                'ST': { topIITs: 720, oldIITs: 3000, newIITs: 9000 }
            }
        };

        // GATE 2026 Expected Cutoff Ranges
        const gate2026CutoffRanges = {
            "CE": { GEN: [29, 30], OBC: [26, 27], SC_ST: [19, 20] },
            "ME": { GEN: [30, 32], OBC: [27, 29], SC_ST: [20, 22] },
            "EE": { GEN: [24, 26], OBC: [22, 23], SC_ST: [16, 17] },
            "EC": { GEN: [25, 27], OBC: [22, 24], SC_ST: [16, 18] },
            "CS": { GEN: [29, 31], OBC: [26, 28], SC_ST: [19, 21] },
            "IN": { GEN: [31, 33], OBC: [28, 30], SC_ST: [21, 23] },
            "PI": { GEN: [36, 38], OBC: [32, 34], SC_ST: [23, 25] },
            "XE": { GEN: [36, 38], OBC: [32, 34], SC_ST: [23, 25] },
            "ES": { GEN: [28, 30], OBC: [25, 27], SC_ST: [18, 20] },
            "CH": { GEN: [29, 31], OBC: [26, 28], SC_ST: [19, 21] },
            "DA": { GEN: [36, 38], OBC: [32, 34], SC_ST: [23, 25] }
        };

        let rankChart = null;
        let currentCategory = 'GEN';

        // Show category benefits information
        function showCategoryInfo(category) {
            const categoryInfo = document.getElementById('categoryInfo');
            const benefitsText = document.getElementById('categoryBenefitsText');
            
            benefitsText.textContent = categoryBenefits[category];
            categoryInfo.classList.add('show');
        }

        // Input validation for 1-mark and 2-mark questions
        function validateInput(type) {
            const correctInput = document.getElementById(`${type}Correct`);
            const wrongInput = document.getElementById(`${type}Wrong`);
            const errorElement = document.getElementById(`${type}Error`);
            const wrongErrorElement = document.getElementById(`${type}WrongError`);
            
            const maxQuestions = type === 'type1' ? 30 : 35;
            const correct = parseInt(correctInput.value) || 0;
            const wrong = parseInt(wrongInput.value) || 0;
            
            let hasError = false;
            
            // Check correct answers
            if (correct > maxQuestions) {
                errorElement.textContent = `Cannot exceed ${maxQuestions} questions`;
                errorElement.style.display = 'block';
                correctInput.classList.add('invalid');
                hasError = true;
            } else {
                errorElement.style.display = 'none';
                correctInput.classList.remove('invalid');
            }
            
            // Check wrong answers
            if (wrong > maxQuestions) {
                wrongErrorElement.textContent = `Cannot exceed ${maxQuestions} questions`;
                wrongErrorElement.style.display = 'block';
                wrongInput.classList.add('invalid');
                hasError = true;
            } else if (correct + wrong > maxQuestions) {
                wrongErrorElement.textContent = `Total ${type === 'type1' ? '1-mark' : '2-mark'} questions cannot exceed ${maxQuestions}`;
                wrongErrorElement.style.display = 'block';
                wrongInput.classList.add('invalid');
                hasError = true;
            } else {
                wrongErrorElement.style.display = 'none';
                wrongInput.classList.remove('invalid');
            }
            
            updatePredictButton();
            updateMarks();
            
            return !hasError;
        }

        function updatePredictButton() {
            const predictBtn = document.getElementById('predictBtn');
            const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
            const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
            const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
            const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
            
            const totalQuestions = type1Correct + type1Wrong + type2Correct + type2Wrong;
            
            if (totalQuestions === 0) {
                predictBtn.disabled = true;
            } else {
                predictBtn.disabled = false;
            }
        }

        // Select category function
        function selectCategory(category) {
            currentCategory = category;
            document.getElementById('category').value = category;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const categoryButtons = {
                'GEN': 'General',
                'OBC': 'OBC-NCL', 
                'EWS': 'EWS',
                'SC': 'SC',
                'ST': 'ST',
                'PWD': 'PwD'
            };
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                if (btn.textContent === categoryButtons[category]) {
                    btn.classList.add('active');
                }
            });
            
            showCategoryInfo(category);
            updateMarks();
        }

        // Update marks calculation
        function updateMarks() {
            const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
            const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
            const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
            const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
            
            const type1Marks = type1Correct - (type1Wrong * 0.33);
            const type2Marks = (type2Correct * 2) - (type2Wrong * 0.67);
            const totalMarks = type1Marks + type2Marks;
            
            document.getElementById('type1Marks').textContent = Math.max(type1Marks, 0).toFixed(2);
            document.getElementById('type2Marks').textContent = Math.max(type2Marks, 0).toFixed(2);
            document.getElementById('totalMarks').textContent = Math.max(totalMarks, 0).toFixed(2);
        }

        // Calculate rank from marks with category adjustment
        function calculateRankWithCategory(marks, category) {
            const sortedData = [...gateCS2025Data].sort((a, b) => b.marks - a.marks);
            
            if (marks > sortedData[0].marks) return 1;
            if (marks < sortedData[sortedData.length - 1].marks) {
                const last = sortedData[sortedData.length - 1];
                const secondLast = sortedData[sortedData.length - 2];
                const slope = (last.rank - secondLast.rank) / (last.marks - secondLast.marks);
                const baseRank = Math.round(last.rank + (marks - last.marks) * slope);
                return applyCategoryMultiplier(baseRank, category);
            }
            
            for (let i = 0; i < sortedData.length - 1; i++) {
                if (marks <= sortedData[i].marks && marks >= sortedData[i + 1].marks) {
                    const lower = sortedData[i];
                    const upper = sortedData[i + 1];
                    const marksRange = lower.marks - upper.marks;
                    const rankRange = lower.rank - upper.rank;
                    const fraction = (lower.marks - marks) / marksRange;
                    const baseRank = Math.round(lower.rank - (fraction * rankRange));
                    return applyCategoryMultiplier(baseRank, category);
                }
            }
            
            return applyCategoryMultiplier(25000, category);
        }

        // Apply category multiplier to rank
        function applyCategoryMultiplier(rank, category) {
            const multiplier = categoryMultipliers[category] || 1.0;
            return Math.round(rank / multiplier);
        }

        // Calculate rank for all categories
        function calculateAllCategoryRanks(marks) {
            const categories = ['GEN', 'OBC', 'EWS', 'SC', 'ST', 'PWD'];
            const ranks = {};
            
            categories.forEach(category => {
                ranks[category] = calculateRankWithCategory(marks, category);
            });
            
            return ranks;
        }

        // Calculate percentile
        function calculatePercentile(rank) {
            const totalCandidates = 23003; // From CS data
            const percentile = ((totalCandidates - rank) / totalCandidates) * 100;
            return Math.min(99.99, Math.max(0.01, percentile.toFixed(2)));
        }

        // Calculate GATE Score
        function calculateGATEScore(rank) {
            // GATE score formula simplified
            const maxRank = 23003;
            const normalizedScore = 1000 * (1 - (rank - 1) / (maxRank - 1));
            return Math.round(Math.max(350, normalizedScore));
        }

        // Get IIT chances
        function getIITChances(rank, paper, category) {
            const paperCutoffs = iitCutoffs[paper] || iitCutoffs["CS"];
            const categoryCutoffs = paperCutoffs[category] || paperCutoffs["GEN"];
            
            const getChance = (rank, cutoff) => {
                if (rank <= cutoff) return { level: "high", label: "High Chance" };
                if (rank <= cutoff * 1.5) return { level: "medium", label: "Medium Chance" };
                return { level: "low", label: "Low Chance" };
            };
            
            return {
                topIITs: getChance(rank, categoryCutoffs.topIITs),
                oldIITs: getChance(rank, categoryCutoffs.oldIITs),
                newIITs: getChance(rank, categoryCutoffs.newIITs)
            };
        }

        // Get PSU chance level
        function getPSUChance(rank, category) {
            const adjustedRank = rank * categoryMultipliers[category];
            
            if (adjustedRank <= 200) return "Very High";
            if (adjustedRank <= 1000) return "High";
            if (adjustedRank <= 3000) return "Moderate";
            if (adjustedRank <= 7000) return "Low";
            return "Very Low";
        }

        // Get PSU description
        function getPSUDescription(psuLevel) {
            const descriptions = {
                "Very High": "Excellent chances for top PSUs like ISRO, BARC, DRDO, IOCL, NTPC, BHEL, PGCIL",
                "High": "Good chances for major PSUs including ONGC, GAIL, HPCL, SAIL, POWERGRID",
                "Moderate": "Decent chances for most PSUs, may need interview excellence",
                "Low": "Limited chances, consider applying to all PSUs and focus on interview",
                "Very Low": "Minimal chances, consider improving rank for better opportunities"
            };
            return descriptions[psuLevel] || "PSU chances will depend on actual vacancies and interview performance.";
        }

        // Update category performance stats
        function updateCategoryPerformance(marks) {
            const allRanks = calculateAllCategoryRanks(marks);
            const currentRank = allRanks[currentCategory];
            
            let html = '';
            Object.entries(allRanks).forEach(([category, rank]) => {
                const difference = currentRank - rank;
                const diffText = difference > 0 ? 
                    `Better by ${difference.toLocaleString()} ranks` : 
                    `Same rank`;
                
                html += `
                    <div class="category-stat">
                        <div class="category-stat-title">${getCategoryName(category)}</div>
                        <div class="category-stat-value">${rank.toLocaleString()}</div>
                        <div class="category-stat-difference ${difference > 0 ? 'positive' : ''}">
                            ${diffText}
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('categoryStats').innerHTML = html;
        }

        // Get category name
        function getCategoryName(code) {
            const names = {
                'GEN': 'General',
                'OBC': 'OBC-NCL',
                'EWS': 'EWS',
                'SC': 'SC',
                'ST': 'ST',
                'PWD': 'PwD'
            };
            return names[code] || code;
        }

        // Update IIT colleges display
        function updateIITColleges(rank, paper, category) {
            const chances = getIITChances(rank, paper, category);
            const paperCutoffs = iitCutoffs[paper] || iitCutoffs["CS"];
            const categoryCutoffs = paperCutoffs[category] || paperCutoffs["GEN"];
            
            const html = `
                <div class="iit-college ${chances.topIITs.level}">
                    <div class="iit-college-icon">
                        <i class="fas fa-crown"></i>
                    </div>
                    <div class="iit-college-title">Top IITs</div>
                    <div class="iit-college-chance ${chances.topIITs.level}">
                        ${chances.topIITs.label}
                    </div>
                    <div class="iit-college-rank">Cutoff: Rank â‰¤ ${categoryCutoffs.topIITs}</div>
                    <div class="iit-college-rank">Your Rank: ${rank.toLocaleString()}</div>
                </div>
                
                <div class="iit-college ${chances.oldIITs.level}">
                    <div class="iit-college-icon">
                        <i class="fas fa-building"></i>
                    </div>
                    <div class="iit-college-title">Old IITs</div>
                    <div class="iit-college-chance ${chances.oldIITs.level}">
                        ${chances.oldIITs.label}
                    </div>
                    <div class="iit-college-rank">Cutoff: Rank â‰¤ ${categoryCutoffs.oldIITs}</div>
                    <div class="iit-college-rank">Your Rank: ${rank.toLocaleString()}</div>
                </div>
                
                <div class="iit-college ${chances.newIITs.level}">
                    <div class="iit-college-icon">
                        <i class="fas fa-school"></i>
                    </div>
                    <div class="iit-college-title">New IITs</div>
                    <div class="iit-college-chance ${chances.newIITs.level}">
                        ${chances.newIITs.label}
                    </div>
                    <div class="iit-college-rank">Cutoff: Rank â‰¤ ${categoryCutoffs.newIITs}</div>
                    <div class="iit-college-rank">Your Rank: ${rank.toLocaleString()}</div>
                </div>
            `;
            
            document.getElementById('iitColleges').innerHTML = html;
        }

        // Update category chart
        function updateCategoryChart(marks) {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            const allRanks = calculateAllCategoryRanks(marks);
            
            const categories = ['GEN', 'OBC', 'EWS', 'SC', 'ST', 'PWD'];
            const ranks = categories.map(cat => allRanks[cat]);
            const labels = categories.map(getCategoryName);
            
            if (rankChart) {
                rankChart.destroy();
            }
            
            rankChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Predicted Rank (Lower is Better)',
                        data: ranks,
                        backgroundColor: [
                            'rgba(52, 152, 219, 0.7)',
                            'rgba(155, 89, 182, 0.7)',
                            'rgba(52, 152, 219, 0.7)',
                            'rgba(46, 204, 113, 0.7)',
                            'rgba(241, 196, 15, 0.7)',
                            'rgba(230, 126, 34, 0.7)'
                        ],
                        borderColor: [
                            'rgb(52, 152, 219)',
                            'rgb(155, 89, 182)',
                            'rgb(52, 152, 219)',
                            'rgb(46, 204, 113)',
                            'rgb(241, 196, 15)',
                            'rgb(230, 126, 34)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Category-wise Rank Comparison',
                            font: {size: 16, weight: 'bold'}
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Rank: ${context.parsed.y.toLocaleString()}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Rank (Lower is Better)',
                                font: {size: 14, weight: 'bold'}
                            },
                            reverse: true,
                            ticks: {
                                callback: value => value.toLocaleString()
                            }
                        }
                    }
                }
            });
        }

        // Create scores table with category-wise ranks
        function createScoresTable(paper, userMarks) {
            const cutoffRanges = gate2026CutoffRanges[paper] || gate2026CutoffRanges["CS"];
            const allRanks = calculateAllCategoryRanks(userMarks);
            const categoryMap = { 
                GEN: "General", 
                OBC: "OBC-NCL", 
                EWS: "EWS", 
                SC: "SC", 
                ST: "ST", 
                PWD: "PwD" 
            };
            
            let html = '';
            
            Object.entries(categoryMap).forEach(([code, name]) => {
                const cutoffRange = cutoffRanges[code === "SC" || code === "ST" ? "SC_ST" : code] || cutoffRanges["GEN"];
                const cutoff2026 = Array.isArray(cutoffRange) ? cutoffRange : [cutoffRange, cutoffRange];
                const passes = userMarks >= cutoff2026[0];
                const rank = allRanks[code];
                
                html += `
                    <tr ${code === currentCategory ? 'style="background: rgba(52, 152, 219, 0.1); font-weight: 600;"' : ''}>
                        <td>${name}${code === currentCategory ? ' (You)' : ''}</td>
                        <td>${cutoff2026[0]} - ${cutoff2026[1]}</td>
                        <td>${userMarks.toFixed(1)}</td>
                        <td>
                            ${passes ? 
                                `<span style="color: var(--success); font-weight: 600;">PASS</span>` : 
                                `<span style="color: var(--danger); font-weight: 600;">FAIL</span>`
                            }
                        </td>
                        <td>${rank.toLocaleString()}</td>
                    </tr>
                `;
            });
            
            return html;
        }

        // Reset form for "Predict Again"
        function resetForm() {
            document.getElementById('type1Correct').value = "15";
            document.getElementById('type1Wrong').value = "2";
            document.getElementById('type2Correct').value = "10";
            document.getElementById('type2Wrong').value = "1";
            document.getElementById('category').value = "GEN";
            currentCategory = 'GEN';
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent === 'General') {
                    btn.classList.add('active');
                }
            });
            
            document.getElementById('predictBtn').style.display = 'inline-flex';
            document.getElementById('predictAgainBtn').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('categoryInfo').classList.remove('show');
            
            updateMarks();
            validateInput('type1');
            validateInput('type2');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Main prediction function
        function predictRank() {
            if (!validateInput('type1') || !validateInput('type2')) {
                alert('Please fix the input errors before predicting.');
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
            
            setTimeout(() => {
                const paper = document.getElementById('paper').value;
                const category = currentCategory;
                
                const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
                const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
                const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
                const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
                
                const type1Marks = type1Correct - (type1Wrong * 0.33);
                const type2Marks = (type2Correct * 2) - (type2Wrong * 0.67);
                const userMarks = type1Marks + type2Marks;
                
                // Calculate ranks
                const allRanks = calculateAllCategoryRanks(userMarks);
                const predictedRank = allRanks[category];
                
                // Calculate range (Â±15%)
                const rankLower = Math.round(predictedRank * 0.85);
                const rankUpper = Math.round(predictedRank * 1.15);
                
                // Calculate other metrics
                const gateScore = calculateGATEScore(predictedRank);
                const percentile = calculatePercentile(predictedRank);
                const psuChance = getPSUChance(predictedRank, category);
                
                // Update main results display
                document.getElementById('predictedRank').textContent = predictedRank.toLocaleString();
                document.getElementById('gateScore').textContent = gateScore;
                document.getElementById('percentile').textContent = `${percentile}%`;
                document.getElementById('rankRangeValue').textContent = `${rankLower.toLocaleString()} - ${rankUpper.toLocaleString()}`;
                document.getElementById('rankRangeDisplay').textContent = `${rankLower.toLocaleString()} - ${rankUpper.toLocaleString()}`;
                document.getElementById('rankRange').textContent = `${rankLower.toLocaleString()} - ${rankUpper.toLocaleString()}`;
                
                // Update category performance
                updateCategoryPerformance(userMarks);
                
                // Update IIT possibilities
                updateIITColleges(predictedRank, paper, category);
                
                // Update PSU chances
                document.getElementById('psuLevel').textContent = psuChance;
                document.getElementById('psuLevel').className = `psu-level psu-${psuChance.toLowerCase().replace(/ /g, '-')}`;
                document.getElementById('psuDescription').textContent = getPSUDescription(psuChance);
                
                // Update scores table
                document.getElementById('scoresTableBody').innerHTML = createScoresTable(paper, userMarks);
                
                // Update category chart
                updateCategoryChart(userMarks);
                
                // Show results and update buttons
                document.getElementById('loading').style.display = 'none';
                document.getElementById('resultsSection').style.display = 'block';
                document.getElementById('predictBtn').style.display = 'none';
                document.getElementById('predictAgainBtn').style.display = 'inline-flex';
                
                // Scroll to results
                document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            }, 1500);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', function() {
            updateMarks();
            updatePredictButton();
            showCategoryInfo('GEN');
            
            // Add event listener for paper change
            document.getElementById('paper').addEventListener('change', function() {
                document.getElementById('type1Correct').value = "15";
                document.getElementById('type1Wrong').value = "2";
                document.getElementById('type2Correct').value = "10";
                document.getElementById('type2Wrong').value = "1";
                updateMarks();
                validateInput('type1');
                validateInput('type2');
            });
        });
    </script>
</body>
</html>
