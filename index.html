<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GATE 2026 Rank Predictor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: #1a237e;
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .content {
            padding: 30px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        select:focus, input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }

        .input-row > div {
            flex: 1;
        }

        .input-row label {
            font-size: 0.9rem;
            color: #666;
        }

        .quick-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .quick-btn {
            flex: 1;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .predict-btn {
            background: linear-gradient(to right, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .predict-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .results {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .results h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .result-card {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .result-card h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: bold;
            margin: 5px 0;
        }

        .result-subtext {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .qualification-status {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 15px 0;
        }

        .qualified {
            color: #4CAF50;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .not-qualified {
            color: #f44336;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .category-ranks {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .category-card {
            background: rgba(255,255,255,0.2);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .opportunities {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }

        .opportunity-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }

        .college-list, .psu-list {
            list-style: none;
        }

        .college-item, .psu-item {
            background: #f8f9fa;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #e9ecef;
        }

        .college-badge, .psu-badge {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: bold;
            margin-left: 5px;
        }

        .iit-badge {
            background: #FF5722;
            color: white;
        }

        .iisc-badge {
            background: #9C27B0;
            color: white;
        }

        .nit-badge {
            background: #2196F3;
            color: white;
        }

        .research-badge {
            background: #4CAF50;
            color: white;
        }

        .maharatna-badge {
            background: #FF9800;
            color: white;
        }

        .navratna-badge {
            background: #795548;
            color: white;
        }

        .loading {
            text-align: center;
            padding: 20px;
            display: none;
        }

        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
        }

        .chance-indicator {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            margin-top: 4px;
            display: inline-block;
        }

        .high-chance {
            background: #e8f5e9;
            color: #4CAF50;
            border: 1px solid #c8e6c9;
        }

        .medium-chance {
            background: #fff3e0;
            color: #FF9800;
            border: 1px solid #ffe0b2;
        }

        .low-chance {
            background: #ffebee;
            color: #F44336;
            border: 1px solid #ffcdd2;
        }

        .reservation-note {
            font-size: 0.8rem;
            color: #666;
            margin-top: 5px;
            padding: 5px;
            background: #f0f0f0;
            border-radius: 5px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .input-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .quick-buttons {
                flex-direction: column;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .category-ranks {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .opportunity-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>GATE 2026 Rank Predictor</h1>
            <p>Get your predicted rank, score, and college opportunities with reservation categories</p>
        </div>
        
        <div class="content">
            <div class="input-section">
                <div class="quick-buttons">
                    <button class="quick-btn" onclick="fillTopScore()">Top Score (65+ Marks)</button>
                    <button class="quick-btn" onclick="fillGoodScore()">Good Score</button>
                    <button class="quick-btn" onclick="resetForm()">Reset</button>
                </div>
                
                <div class="form-group">
                    <label>Select Your Paper:</label>
                    <select id="paperCode">
                        <option value="CS">Computer Science (CS)</option>
                        <option value="EC">Electronics & Communication (EC)</option>
                        <option value="EE">Electrical Engineering (EE)</option>
                        <option value="ME">Mechanical Engineering (ME)</option>
                        <option value="CE">Civil Engineering (CE)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>Your Category:</label>
                    <select id="category">
                        <option value="GEN">General (GEN)</option>
                        <option value="EWS">EWS</option>
                        <option value="OBC">OBC-NCL</option>
                        <option value="SC">SC</option>
                        <option value="ST">ST</option>
                        <option value="PwD">PwD</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>For 1-mark Questions (Total: 30):</label>
                    <div class="input-row">
                        <div>
                            <label>Correct Answers</label>
                            <input type="number" id="correct1" min="0" max="30" value="22">
                        </div>
                        <div>
                            <label>Wrong Answers</label>
                            <input type="number" id="wrong1" min="0" max="30" value="4">
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>For 2-mark Questions (Total: 35):</label>
                    <div class="input-row">
                        <div>
                            <label>Correct Answers</label>
                            <input type="number" id="correct2" min="0" max="35" value="25">
                        </div>
                        <div>
                            <label>Wrong Answers</label>
                            <input type="number" id="wrong2" min="0" max="35" value="6">
                        </div>
                    </div>
                </div>
                
                <button class="predict-btn" onclick="predictEverything()">Predict Rank & Opportunities</button>
            </div>
            
            <div class="loading" id="loading">
                <div class="loader"></div>
                <p>Analyzing your GATE score...</p>
            </div>
            
            <div class="results" id="results">
                <h2>Your GATE 2026 Prediction</h2>
                
                <div class="results-grid">
                    <div class="result-card">
                        <h3>Predicted AIR</h3>
                        <div class="result-value" id="predictedRank">--</div>
                        <div class="result-subtext" id="rankRange">Range: --</div>
                    </div>
                    
                    <div class="result-card">
                        <h3>Expected Score</h3>
                        <div class="result-value" id="predictedScore">--</div>
                        <div class="result-subtext">Out of 1000</div>
                    </div>
                    
                    <div class="result-card">
                        <h3>Marks Obtained</h3>
                        <div class="result-value" id="predictedMarks">--</div>
                        <div class="result-subtext">Out of 100</div>
                    </div>
                    
                    <div class="result-card">
                        <h3>Percentile</h3>
                        <div class="result-value" id="percentile">--</div>
                        <div class="result-subtext">Top --%</div>
                    </div>
                </div>
                
                <div class="qualification-status" id="qualificationStatus">
                    <h3>GATE Qualification Status</h3>
                    <div id="qualificationResult" class="qualified">Loading...</div>
                    <div id="cutoffDetails" style="margin-top: 5px; font-size: 0.9rem;"></div>
                </div>
                
                <div>
                    <h3 style="text-align: center; margin: 15px 0;">Category-wise AIR (with Reservation)</h3>
                    <div class="category-ranks">
                        <div class="category-card">
                            <div style="font-size: 0.9rem;">General (GEN)</div>
                            <div style="font-size: 1.2rem; font-weight: bold;" id="rankGEN">--</div>
                        </div>
                        <div class="category-card">
                            <div style="font-size: 0.9rem;">OBC-NCL</div>
                            <div style="font-size: 1.2rem; font-weight: bold;" id="rankOBC">--</div>
                        </div>
                        <div class="category-card">
                            <div style="font-size: 0.9rem;">SC</div>
                            <div style="font-size: 1.2rem; font-weight: bold;" id="rankSC">--</div>
                        </div>
                        <div class="category-card">
                            <div style="font-size: 0.9rem;">ST</div>
                            <div style="font-size: 1.2rem; font-weight: bold;" id="rankST">--</div>
                        </div>
                    </div>
                    <div class="reservation-note">
                        Note: Ranks shown are All India Ranks (AIR) with category reservation considered
                    </div>
                </div>
            </div>
            
            <div class="opportunities" id="opportunities">
                <h3 style="text-align: center; margin-bottom: 15px;">Opportunities Based on Your Score</h3>
                <div class="opportunity-grid">
                    <div>
                        <h4 style="text-align: center; margin-bottom: 15px; color: #1a237e;">ðŸŽ“ IITs & Top Colleges</h4>
                        <ul class="college-list" id="collegeList">
                            <!-- IITs will be added here -->
                        </ul>
                    </div>
                    <div>
                        <h4 style="text-align: center; margin-bottom: 15px; color: #1a237e;">ðŸ’¼ PSU Job Opportunities</h4>
                        <ul class="psu-list" id="psuList">
                            <!-- PSUs will be added here -->
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <p>Â© 2026 GATE Rank Predictor | Includes proper reservation calculations</p>
                <p style="font-size: 0.8rem; margin-top: 5px;">Reservation percentages: GEN(40.5%) | OBC(27%) | SC(15%) | ST(7.5%) | EWS(10%) | PwD(5%)</p>
            </div>
        </div>
    </div>

    <script>
        // GATE Data with reservation categories
        const gate2025Data = [
            { rank: 1, score: 1000, marks: 100 },
            { rank: 10, score: 970, marks: 90.2 },
            { rank: 50, score: 920, marks: 85.5 },
            { rank: 100, score: 890, marks: 82.8 },
            { rank: 200, score: 850, marks: 79.0 },
            { rank: 500, score: 800, marks: 74.0 },
            { rank: 1000, score: 750, marks: 69.5 },
            { rank: 2000, score: 700, marks: 64.8 },
            { rank: 5000, score: 650, marks: 60.0 },
            { rank: 10000, score: 600, marks: 55.2 },
            { rank: 15000, score: 550, marks: 50.5 },
            { rank: 20000, score: 500, marks: 46.0 },
            { rank: 25000, score: 450, marks: 41.5 },
            { rank: 30000, score: 400, marks: 37.0 }
        ];

        const gateCutoffs = {
            'CS': { 
                GEN: 30.5, EWS: 27.2, OBC: 27.2, SC: 20.8, ST: 20.5, PwD: 20.5 
            },
            'CE': { 
                GEN: 30.2, EWS: 26.2, OBC: 26.2, SC: 20.4, ST: 20.4, PwD: 20.4 
            },
            'EC': { 
                GEN: 26.0, EWS: 23.5, OBC: 23.5, SC: 18.0, ST: 17.6, PwD: 17.6 
            },
            'EE': { 
                GEN: 26.0, EWS: 23.5, OBC: 23.5, SC: 18.0, ST: 17.6, PwD: 17.6 
            },
            'ME': { 
                GEN: 36.8, EWS: 33.2, OBC: 33.2, SC: 25.8, ST: 24.8, PwD: 24.8 
            }
        };

        // IITs with reservation seat percentages
        const iits = [
            { 
                name: "IIT Bombay", 
                minScore: 800, 
                category: "IIT", 
                badge: "iit-badge"
            },
            { 
                name: "IIT Delhi", 
                minScore: 780, 
                category: "IIT", 
                badge: "iit-badge"
            },
            { 
                name: "IIT Madras", 
                minScore: 770, 
                category: "IIT", 
                badge: "iit-badge"
            },
            { 
                name: "IIT Kanpur", 
                minScore: 760, 
                category: "IIT", 
                badge: "iit-badge"
            },
            { 
                name: "IIT Kharagpur", 
                minScore: 750, 
                category: "IIT", 
                badge: "iit-badge"
            },
            { 
                name: "IISC Bangalore", 
                minScore: 790, 
                category: "IISC", 
                badge: "iisc-badge"
            },
            { 
                name: "IIT Roorkee", 
                minScore: 740, 
                category: "IIT", 
                badge: "iit-badge"
            },
            { 
                name: "IIT Hyderabad", 
                minScore: 730, 
                category: "IIT", 
                badge: "iit-badge"
            }
        ];

        const nits = [
            { 
                name: "NIT Trichy", 
                minScore: 700, 
                category: "NIT", 
                badge: "nit-badge" 
            },
            { 
                name: "NIT Warangal", 
                minScore: 690, 
                category: "NIT", 
                badge: "nit-badge" 
            },
            { 
                name: "NIT Surathkal", 
                minScore: 680, 
                category: "NIT", 
                badge: "nit-badge" 
            },
            { 
                name: "NIT Rourkela", 
                minScore: 670, 
                category: "NIT", 
                badge: "nit-badge" 
            }
        ];

        const psus = [
            { 
                name: "DRDO", 
                minScore: 780, 
                category: "Research", 
                badge: "research-badge",
                reservation: true 
            },
            { 
                name: "ISRO", 
                minScore: 800, 
                category: "Research", 
                badge: "research-badge",
                reservation: true 
            },
            { 
                name: "ONGC", 
                minScore: 720, 
                category: "Maharatna", 
                badge: "maharatna-badge",
                reservation: true 
            },
            { 
                name: "BHEL", 
                minScore: 700, 
                category: "Maharatna", 
                badge: "maharatna-badge",
                reservation: true 
            },
            { 
                name: "NTPC", 
                minScore: 690, 
                category: "Maharatna", 
                badge: "maharatna-badge",
                reservation: true 
            },
            { 
                name: "Power Grid", 
                minScore: 680, 
                category: "Maharatna", 
                badge: "maharatna-badge",
                reservation: true 
            },
            { 
                name: "GAIL", 
                minScore: 670, 
                category: "Maharatna", 
                badge: "maharatna-badge",
                reservation: true 
            },
            { 
                name: "BEL", 
                minScore: 660, 
                category: "Navratna", 
                badge: "navratna-badge",
                reservation: true 
            }
        ];

        // Quick buttons functions
        function fillTopScore() {
            document.getElementById('correct1').value = 24;
            document.getElementById('wrong1').value = 3;
            document.getElementById('correct2').value = 28;
            document.getElementById('wrong2').value = 4;
        }

        function fillGoodScore() {
            document.getElementById('correct1').value = 18;
            document.getElementById('wrong1').value = 5;
            document.getElementById('correct2').value = 20;
            document.getElementById('wrong2').value = 8;
        }

        function resetForm() {
            document.getElementById('correct1').value = '';
            document.getElementById('wrong1').value = '';
            document.getElementById('correct2').value = '';
            document.getElementById('wrong2').value = '';
            document.getElementById('results').style.display = 'none';
            document.getElementById('opportunities').style.display = 'none';
        }

        // Main prediction function
        function predictEverything() {
            // Validate inputs
            const correct1 = parseInt(document.getElementById('correct1').value) || 0;
            const wrong1 = parseInt(document.getElementById('wrong1').value) || 0;
            const correct2 = parseInt(document.getElementById('correct2').value) || 0;
            const wrong2 = parseInt(document.getElementById('wrong2').value) || 0;
            
            if (correct1 === 0 && wrong1 === 0 && correct2 === 0 && wrong2 === 0) {
                alert('Please enter your answer details');
                return;
            }
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            document.getElementById('opportunities').style.display = 'none';
            
            // Calculate marks
            const marks = calculateMarks(correct1, wrong1, correct2, wrong2);
            
            // Get other inputs
            const paper = document.getElementById('paperCode').value;
            const category = document.getElementById('category').value;
            
            // Simulate processing
            setTimeout(() => {
                // Calculate score from marks
                const score = marksToScore(marks);
                
                // Predict rank
                const predictedRank = predictRank(score, paper, category);
                
                // Check qualification
                const qualification = checkQualification(marks, paper, category);
                
                // Calculate category-wise ranks with CORRECT reservation logic
                const categoryRanks = calculateCategoryRanks(predictedRank, category);
                
                // Get opportunities with reservation consideration
                const collegeOpps = getCollegeOpportunities(score, category, predictedRank);
                const psuOpps = getPSUOpportunities(score, category);
                
                // Display results
                displayResults(predictedRank, marks, score, qualification, categoryRanks, collegeOpps, psuOpps);
                
                // Hide loading, show results
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results').style.display = 'block';
                document.getElementById('opportunities').style.display = 'block';
                
                // Scroll to results
                document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            }, 1000);
        }

        function calculateMarks(correct1, wrong1, correct2, wrong2) {
            const marks1 = (correct1 * 1) - (wrong1 * 0.33);
            const marks2 = (correct2 * 2) - (wrong2 * 0.66);
            const totalMarks = marks1 + marks2;
            return Math.max(0, parseFloat(totalMarks.toFixed(2)));
        }

        function marksToScore(marks) {
            if (marks >= 100) return 1000;
            if (marks <= 37) return 400;
            
            // Simple linear interpolation
            for (let i = 0; i < gate2025Data.length - 1; i++) {
                if (marks >= gate2025Data[i].marks && marks <= gate2025Data[i+1].marks) {
                    const ratio = (marks - gate2025Data[i].marks) / (gate2025Data[i+1].marks - gate2025Data[i].marks);
                    return Math.round(gate2025Data[i].score + (gate2025Data[i+1].score - gate2025Data[i].score) * ratio);
                }
            }
            
            // Fallback calculation
            return Math.round(400 + (marks - 37) * 15);
        }

        function predictRank(score, paper, category) {
            // Base rank from score
            let rank = 1;
            for (let i = gate2025Data.length - 1; i >= 0; i--) {
                if (score <= gate2025Data[i].score) {
                    rank = gate2025Data[i].rank;
                    break;
                }
            }
            
            // Adjust for paper difficulty
            const paperMultipliers = {
                'CS': 1.2,  // High competition
                'CE': 1.1,  // Medium competition
                'EC': 1.0,
                'EE': 1.0,
                'ME': 1.0
            };
            rank = Math.round(rank * (paperMultipliers[paper] || 1));
            
            return Math.max(1, rank);
        }

        function calculateCategoryRanks(generalRank, userCategory) {
            // CORRECTED: Reservation percentages mean better (lower) ranks for reserved categories
            // If GEN rank is 80, then:
            // OBC should be better than 80 (lower number)
            // SC should be much better (even lower number)
            // ST should be best (lowest number)
            
            const ranks = {
                'GEN': generalRank,  // General rank is the base
                'EWS': Math.max(1, Math.round(generalRank * 0.85)),  // EWS: 85% of GEN rank (better)
                'OBC': Math.max(1, Math.round(generalRank * 0.65)),  // OBC: 65% of GEN rank (better)
                'SC': Math.max(1, Math.round(generalRank * 0.35)),   // SC: 35% of GEN rank (much better)
                'ST': Math.max(1, Math.round(generalRank * 0.20)),   // ST: 20% of GEN rank (best)
                'PwD': Math.max(1, Math.round(generalRank * 0.15))   // PwD: 15% of GEN rank (best)
            };
            
            // Ensure logical ordering: ST < SC < OBC < EWS < GEN
            ranks['ST'] = Math.min(ranks['ST'], ranks['SC'] - 10);
            ranks['SC'] = Math.min(ranks['SC'], ranks['OBC'] - 20);
            ranks['OBC'] = Math.min(ranks['OBC'], ranks['EWS'] - 15);
            ranks['EWS'] = Math.min(ranks['EWS'], ranks['GEN'] - 10);
            
            // Ensure minimum rank of 1
            for (const cat in ranks) {
                ranks[cat] = Math.max(1, ranks[cat]);
            }
            
            // Highlight the user's category
            ranks.userCategory = userCategory;
            ranks.userRank = ranks[userCategory];
            
            return ranks;
        }

        function checkQualification(marks, paper, category) {
            const cutoffs = gateCutoffs[paper] || gateCutoffs['CS'];
            const cutoff = cutoffs[category] || cutoffs['GEN'];
            
            const qualified = marks >= cutoff;
            const difference = (marks - cutoff).toFixed(2);
            
            return {
                qualified: qualified,
                cutoff: cutoff,
                marks: marks,
                difference: difference
            };
        }

        function getCollegeOpportunities(score, category, predictedRank) {
            const opportunities = [];
            
            // Get category-specific rank
            const categoryRanks = calculateCategoryRanks(predictedRank, category);
            const categoryRank = categoryRanks[category];
            
            // Check IITs based on category rank
            iits.forEach(iit => {
                // For IITs, rank matters more than score
                let chance = 'low';
                let requiredRank = 0;
                
                // Define rank cutoffs for different IITs
                if (iit.name === "IIT Bombay") requiredRank = 100;
                else if (iit.name === "IIT Delhi") requiredRank = 150;
                else if (iit.name === "IIT Madras") requiredRank = 200;
                else if (iit.name === "IIT Kanpur") requiredRank = 250;
                else if (iit.name === "IIT Kharagpur") requiredRank = 300;
                else if (iit.name === "IISC Bangalore") requiredRank = 120;
                else if (iit.name === "IIT Roorkee") requiredRank = 400;
                else if (iit.name === "IIT Hyderabad") requiredRank = 500;
                
                // Adjust required rank based on category
                const adjustedRequiredRank = Math.round(requiredRank * getCategoryMultiplier(category));
                
                if (categoryRank <= adjustedRequiredRank * 0.5) chance = 'high';
                else if (categoryRank <= adjustedRequiredRank * 0.8) chance = 'medium';
                else if (categoryRank <= adjustedRequiredRank) chance = 'low';
                
                if (categoryRank <= adjustedRequiredRank) {
                    opportunities.push({
                        ...iit,
                        categoryRank: categoryRank,
                        requiredRank: adjustedRequiredRank,
                        chance: chance
                    });
                }
            });
            
            // Check NITs
            nits.forEach(nit => {
                if (score >= nit.minScore) {
                    opportunities.push({
                        ...nit,
                        yourScore: score,
                        chance: calculateChance(score, nit.minScore)
                    });
                }
            });
            
            return opportunities;
        }

        function getCategoryMultiplier(category) {
            // Higher multiplier means easier to get in (lower required rank)
            const multipliers = {
                'GEN': 1.0,
                'EWS': 0.9,
                'OBC': 0.7,
                'SC': 0.4,
                'ST': 0.3,
                'PwD': 0.25
            };
            return multipliers[category] || 1.0;
        }

        function getPSUOpportunities(score, category) {
            const opportunities = [];
            
            // Adjust score based on category for PSUs
            const categoryMultipliers = {
                'GEN': 1.0,
                'EWS': 0.95,
                'OBC': 0.85,
                'SC': 0.60,
                'ST': 0.50,
                'PwD': 0.45
            };
            
            const adjustedScore = score * (categoryMultipliers[category] || 1.0);
            
            psus.forEach(psu => {
                if (adjustedScore >= psu.minScore) {
                    opportunities.push({
                        ...psu,
                        yourScore: score,
                        adjustedScore: adjustedScore,
                        chance: calculateChance(adjustedScore, psu.minScore)
                    });
                }
            });
            
            return opportunities;
        }

        function calculateChance(score, minScore) {
            if (score >= minScore + 50) return 'high';
            if (score >= minScore + 20) return 'medium';
            return 'low';
        }

        function displayResults(predictedRank, marks, score, qualification, categoryRanks, collegeOpps, psuOpps) {
            // Basic results
            document.getElementById('predictedRank').textContent = `AIR ${predictedRank}`;
            document.getElementById('rankRange').textContent = `Range: ${Math.round(predictedRank * 0.8)} - ${Math.round(predictedRank * 1.2)}`;
            document.getElementById('predictedScore').textContent = score;
            document.getElementById('predictedMarks').textContent = marks.toFixed(2);
            
            // Percentile
            const percentile = ((150000 - predictedRank) / 150000 * 100).toFixed(2);
            document.getElementById('percentile').textContent = `${percentile}%`;
            
            // Category ranks - NOW SHOWING CORRECT LOGIC
            document.getElementById('rankGEN').textContent = `AIR ${categoryRanks.GEN}`;
            document.getElementById('rankOBC').textContent = `AIR ${categoryRanks.OBC}`;
            document.getElementById('rankSC').textContent = `AIR ${categoryRanks.SC}`;
            document.getElementById('rankST').textContent = `AIR ${categoryRanks.ST}`;
            
            // Qualification
            const qualResult = document.getElementById('qualificationResult');
            const cutoffDetails = document.getElementById('cutoffDetails');
            
            if (qualification.qualified) {
                qualResult.className = 'qualified';
                qualResult.textContent = 'âœ… QUALIFIED';
                cutoffDetails.textContent = `Marks: ${marks.toFixed(2)} | Cutoff: ${qualification.cutoff} | Margin: +${qualification.difference}`;
            } else {
                qualResult.className = 'not-qualified';
                qualResult.textContent = 'âŒ NOT QUALIFIED';
                cutoffDetails.textContent = `Marks: ${marks.toFixed(2)} | Cutoff: ${qualification.cutoff} | Required: +${Math.abs(qualification.difference)}`;
            }
            
            // College opportunities
            const collegeList = document.getElementById('collegeList');
            collegeList.innerHTML = '';
            
            if (collegeOpps.length > 0) {
                collegeOpps.forEach(college => {
                    const li = document.createElement('li');
                    li.className = 'college-item';
                    
                    const chanceClass = `chance-indicator ${college.chance}-chance`;
                    
                    li.innerHTML = `
                        <div>
                            <div style="font-weight: 600;">
                                ${college.name}
                                <span class="college-badge ${college.badge}">${college.category}</span>
                            </div>
                            <div class="${chanceClass}">${college.chance.toUpperCase()} CHANCE</div>
                            ${college.categoryRank ? `<div style="font-size: 0.7rem; color: #666;">Your AIR: ${college.categoryRank}</div>` : ''}
                        </div>
                        <div style="background: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem;">
                            ${college.requiredRank ? `AIR â‰¤ ${college.requiredRank}` : `Score: ${college.minScore}`}
                        </div>
                    `;
                    collegeList.appendChild(li);
                });
            } else {
                collegeList.innerHTML = '<li class="college-item" style="text-align: center; color: #666;">Score/Rank too low for IITs/NITs</li>';
            }
            
            // PSU opportunities
            const psuList = document.getElementById('psuList');
            psuList.innerHTML = '';
            
            if (psuOpps.length > 0) {
                psuOpps.forEach(psu => {
                    const li = document.createElement('li');
                    li.className = 'psu-item';
                    
                    const chanceClass = `chance-indicator ${psu.chance}-chance`;
                    
                    li.innerHTML = `
                        <div>
                            <div style="font-weight: 600;">
                                ${psu.name}
                                <span class="psu-badge ${psu.badge}">${psu.category}</span>
                            </div>
                            <div class="${chanceClass}">${psu.chance.toUpperCase()} CHANCE</div>
                            <div style="font-size: 0.7rem; color: #666;">Reservation applied</div>
                        </div>
                        <div style="background: white; padding: 3px 8px; border-radius: 12px; font-size: 0.8rem;">
                            Min: ${psu.minScore}
                        </div>
                    `;
                    psuList.appendChild(li);
                });
            } else {
                psuList.innerHTML = '<li class="psu-item" style="text-align: center; color: #666;">Score too low for listed PSUs</li>';
            }
        }

        // Initialize with default values
        window.onload = function() {
            // Show some initial values
            fillTopScore();
        }
    </script>
</body>
</html>
