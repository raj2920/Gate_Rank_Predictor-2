<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GATE Rank Predictor 2026 | Accurate Rank Prediction</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* Header */
        header {
            background: var(--primary);
            color: white;
            padding: 25px 40px;
            text-align: center;
            position: relative;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo i {
            font-size: 2.5rem;
            color: var(--secondary);
            background: white;
            padding: 10px;
            border-radius: 50%;
        }

        .logo h1 {
            font-size: 2rem;
            font-weight: 800;
        }

        .logo span {
            color: var(--secondary);
        }

        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            color: #ecf0f1;
        }

        /* Main Content */
        .main-content {
            padding: 40px;
        }

        /* Input Section */
        .input-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
        }

        .section-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .section-toggle h2 {
            color: var(--primary);
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-fields {
            display: block;
        }

        .marks-type {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .marks-type h4 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .marks-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        @media (max-width: 768px) {
            .marks-grid {
                grid-template-columns: 1fr;
            }
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.95rem;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .input-group input:focus, .input-group select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }

        /* Category Buttons */
        .category-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        @media (max-width: 600px) {
            .category-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .category-btn {
            padding: 12px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s;
        }

        .category-btn:hover {
            background: #e0e0e0;
        }

        .category-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .quick-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .quick-btn {
            padding: 8px 16px;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: #e0e0e0;
        }

        .quick-btn.active {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        /* Predict Button */
        .predict-container {
            text-align: center;
            margin: 30px 0;
        }

        .predict-btn {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .predict-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(52, 152, 219, 0.4);
        }

        .predict-btn:active {
            transform: translateY(-1px);
        }

        /* Check Again Button */
        .check-again-btn {
            background: linear-gradient(135deg, var(--warning), #e67e22);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 8px 15px rgba(243, 156, 18, 0.3);
            margin-top: 20px;
        }

        .check-again-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 25px rgba(243, 156, 18, 0.4);
        }

        /* Results Section */
        .results-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-top: 20px;
            display: none;
            border: 2px solid var(--secondary);
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-section.visible {
            display: block;
        }

        .results-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #f0f0f0;
        }

        .results-header h2 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        /* Qualification Status */
        .qualification-status {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
            border-radius: 12px;
        }

        .qualified {
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.15), rgba(39, 174, 96, 0.05));
            border: 3px solid var(--success);
        }

        .not-qualified {
            background: linear-gradient(135deg, rgba(231, 76, 60, 0.15), rgba(231, 76, 60, 0.05));
            border: 3px solid var(--danger);
        }

        .status-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .status-title {
            font-size: 1.8rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .status-details {
            font-size: 1.1rem;
            color: #555;
        }

        /* IIT Admission Section */
        .iit-admission {
            background: linear-gradient(135deg, #e8f6f3, #d1f2eb);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 5px solid #1abc9c;
        }

        .iit-admission h4 {
            color: #0e6251;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }

        .iit-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .iit-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .iit-grid {
                grid-template-columns: 1fr;
            }
        }

        .iit-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-top: 4px solid #1abc9c;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .iit-card h5 {
            color: #0e6251;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .iit-marks {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1abc9c;
            margin: 10px 0;
        }

        .iit-type {
            font-size: 0.9rem;
            color: #666;
        }

        /* PSU Chances Section */
        .psu-section {
            background: linear-gradient(135deg, #fff0e1, #ffe3b3);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 5px solid #e67e22;
        }

        .psu-section h4 {
            color: #7d6608;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }

        .psu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .psu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .psu-grid {
                grid-template-columns: 1fr;
            }
        }

        .psu-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-top: 4px solid #e67e22;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .psu-card h5 {
            color: #7d6608;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .psu-chance {
            font-size: 1.5rem;
            font-weight: 700;
            color: #e67e22;
            margin: 10px 0;
        }

        .psu-companies {
            font-size: 0.9rem;
            color: #666;
            margin: 10px 0;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .results-grid {
                grid-template-columns: 1fr;
            }
        }

        .result-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border-top: 4px solid var(--secondary);
        }

        .result-card h4 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .card-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--secondary);
            margin: 15px 0;
        }

        .card-label {
            color: #666;
            font-size: 0.95rem;
        }

        /* Cutoff Section */
        .cutoff-section {
            background: linear-gradient(135deg, #e8f4fc, #d6eaf8);
            padding: 25px;
            border-radius: 12px;
            margin: 25px 0;
            border-left: 5px solid var(--secondary);
        }

        .cutoff-section h4 {
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }

        .cutoff-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .cutoff-table th {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
        }

        .cutoff-table td {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .cutoff-table tr:hover {
            background: #f9f9f9;
        }

        .cutoff-value {
            font-weight: 700;
            color: var(--primary);
        }

        .your-cutoff {
            background: rgba(52, 152, 219, 0.1);
            font-weight: 700;
        }

        .cutoff-diff {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 5px;
        }

        .cutoff-pass {
            background: rgba(39, 174, 96, 0.15);
            color: var(--success);
        }

        .cutoff-fail {
            background: rgba(231, 76, 60, 0.15);
            color: var(--danger);
        }

        .cutoff-increase {
            background: rgba(243, 156, 18, 0.15);
            color: var(--warning);
            font-size: 0.7rem;
            margin-left: 3px;
        }

        .marks-summary {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
        }

        @media (max-width: 600px) {
            .marks-summary {
                grid-template-columns: 1fr;
            }
        }

        .summary-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .summary-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            margin: 5px 0;
        }

        .summary-label {
            color: #666;
            font-size: 0.9rem;
        }

        /* Graph Section */
        .graph-section {
            margin-top: 40px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #e0e0e0;
        }

        .graph-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .graph-header h3 {
            color: var(--primary);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .graph-container {
            height: 350px;
            position: relative;
        }

        /* Footer */
        footer {
            background: var(--primary);
            color: white;
            padding: 30px 40px;
            margin-top: 40px;
            text-align: center;
        }

        .copyright {
            opacity: 0.9;
            font-size: 1rem;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .developer-badge {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            padding: 8px 20px;
            border-radius: 25px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }

        .developer-icon {
            color: white;
            font-size: 1.2rem;
        }

        .developer-name {
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 30px;
        }

        .loading i {
            font-size: 3rem;
            color: var(--secondary);
            margin-bottom: 20px;
            animation: spin 1.5s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading p {
            color: var(--primary);
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* Analysis Box */
        .analysis-box {
            background: linear-gradient(135deg, #fff8e1, #ffeaa7);
            padding: 25px;
            border-radius: 12px;
            margin-top: 30px;
            border-left: 5px solid var(--warning);
        }

        .analysis-box h4 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .analysis-text {
            font-size: 1.1rem;
            line-height: 1.6;
            color: #2c3e50;
        }

        .excellent {
            color: var(--success);
            font-weight: 700;
        }

        .good {
            color: #3498db;
            font-weight: 700;
        }

        .average {
            color: var(--warning);
            font-weight: 700;
        }

        .improve {
            color: var(--danger);
            font-weight: 700;
        }

        /* Share Buttons */
        .share-buttons {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            justify-content: center;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .save-btn {
            background: linear-gradient(135deg, #27ae60, #219653);
            color: white;
        }

        .share-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }

        .share-download {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                border-radius: 15px;
            }

            .main-content {
                padding: 20px;
            }

            .predict-btn, .check-again-btn {
                padding: 15px 30px;
                font-size: 1.1rem;
            }

            .card-value {
                font-size: 2rem;
            }

            header {
                padding: 20px;
            }

            .cutoff-table {
                font-size: 0.9rem;
            }

            .cutoff-table th, .cutoff-table td {
                padding: 10px;
            }

            .share-buttons {
                flex-direction: column;
                align-items: center;
            }

            .share-btn {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <i class="fas fa-graduation-cap"></i>
                <div>
                    <h1>GATE RANK <span>PREDICTOR</span> 2026</h1>
                    <p class="subtitle">Get accurate rank prediction with IIT admission & PSU chances analysis</p>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Input Section -->
            <div class="input-section">
                <div class="section-toggle">
                    <h2><i class="fas fa-edit"></i> Enter Your GATE Details</h2>
                </div>
                
                <div class="input-fields" id="inputFields">
                    <div class="input-group">
                        <label><i class="fas fa-file-alt"></i> Select Your Paper</label>
                        <select id="paper">
                            <option value="CE">Civil Engineering (CE)</option>
                            <option value="ME">Mechanical Engineering (ME)</option>
                            <option value="EE">Electrical Engineering (EE)</option>
                            <option value="EC">Electronics & Communication (EC)</option>
                            <option value="CS" selected>Computer Science (CS)</option>
                            <option value="DA">Data Science & AI (DA)</option>
                            <option value="IN">Instrumentation Engineering (IN)</option>
                            <option value="CH">Chemical Engineering (CH)</option>
                        </select>
                    </div>

                    <div class="marks-type">
                        <h4><i class="fas fa-1"></i> Type 1 Questions (1 Mark Each) - Total 30 Questions</h4>
                        <div class="marks-grid">
                            <div class="input-group">
                                <label>Correct Answers</label>
                                <input type="number" id="type1Correct" min="0" max="30" step="1" value="0" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type1Correct', 20)">20</button>
                                    <button class="quick-btn" onclick="setValue('type1Correct', 25)">25</button>
                                    <button class="quick-btn" onclick="setValue('type1Correct', 28)">28</button>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Wrong Answers</label>
                                <input type="number" id="type1Wrong" min="0" max="30" step="1" value="0" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type1Wrong', 0)">0</button>
                                    <button class="quick-btn" onclick="setValue('type1Wrong', 3)">3</button>
                                    <button class="quick-btn" onclick="setValue('type1Wrong', 5)">5</button>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                            <i class="fas fa-info-circle"></i> Total 1-mark questions: <span id="type1Total">0</span>/30
                        </div>
                    </div>

                    <div class="marks-type">
                        <h4><i class="fas fa-2"></i> Type 2 Questions (2 Marks Each) - Total 35 Questions</h4>
                        <div class="marks-grid">
                            <div class="input-group">
                                <label>Correct Answers</label>
                                <input type="number" id="type2Correct" min="0" max="35" step="1" value="0" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type2Correct', 15)">15</button>
                                    <button class="quick-btn" onclick="setValue('type2Correct', 20)">20</button>
                                    <button class="quick-btn" onclick="setValue('type2Correct', 25)">25</button>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Wrong Answers</label>
                                <input type="number" id="type2Wrong" min="0" max="35" step="1" value="0" oninput="updateMarks()">
                                <div class="quick-buttons">
                                    <button class="quick-btn" onclick="setValue('type2Wrong', 0)">0</button>
                                    <button class="quick-btn" onclick="setValue('type2Wrong', 3)">3</button>
                                    <button class="quick-btn" onclick="setValue('type2Wrong', 5)">5</button>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                            <i class="fas fa-info-circle"></i> Total 2-mark questions: <span id="type2Total">0</span>/35
                        </div>
                    </div>

                    <!-- Category Selection -->
                    <div class="input-group">
                        <label><i class="fas fa-users"></i> Select Your Category</label>
                        <div class="category-buttons">
                            <button class="category-btn active" onclick="selectCategory('GEN')">General</button>
                            <button class="category-btn" onclick="selectCategory('OBC')">OBC-NCL</button>
                            <button class="category-btn" onclick="selectCategory('EWS')">EWS</button>
                            <button class="category-btn" onclick="selectCategory('SC')">SC</button>
                            <button class="category-btn" onclick="selectCategory('ST')">ST</button>
                            <button class="category-btn" onclick="selectCategory('PWD')">PwD</button>
                        </div>
                        <input type="hidden" id="category" value="GEN">
                    </div>

                    <div class="note-box" style="background: #fff8e1; padding: 15px; border-radius: 8px; margin-top: 20px; font-size: 0.9rem;">
                        <p><i class="fas fa-info-circle"></i> <strong>Note:</strong> GATE 2026 cutoffs expected to increase by 1.5 marks. SC/ST categories have lower cutoffs for IIT admissions.</p>
                    </div>
                </div>
            </div>

            <!-- Predict Button -->
            <div class="predict-container">
                <button class="predict-btn" onclick="predictRank()">
                    <i class="fas fa-bolt"></i> PREDICT MY RANK & ANALYSIS
                </button>
            </div>

            <!-- Loading Animation -->
            <div class="loading" id="loading">
                <i class="fas fa-spinner"></i>
                <p>Analyzing your marks and IIT admission chances...</p>
            </div>

            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <div class="results-header">
                    <h2><i class="fas fa-chart-line"></i> Your GATE 2026 Prediction Results</h2>
                    <p>Based on GATE 2025 actual data with 2026 expected cutoffs</p>
                </div>

                <!-- Share Buttons -->
                <div class="share-buttons">
                    <button class="share-btn save-btn" onclick="saveResult()">
                        <i class="fas fa-save"></i> SAVE RESULT
                    </button>
                    <button class="share-btn share-whatsapp" onclick="shareWhatsApp()">
                        <i class="fab fa-whatsapp"></i> SHARE ON WHATSAPP
                    </button>
                    <button class="share-btn share-download" onclick="downloadResult()">
                        <i class="fas fa-download"></i> DOWNLOAD AS IMAGE
                    </button>
                </div>

                <!-- Qualification Status -->
                <div class="qualification-status" id="qualificationStatus">
                    <!-- Will be populated by JavaScript -->
                </div>

                <!-- Marks Summary -->
                <div class="marks-summary">
                    <div class="summary-item">
                        <div class="summary-label">Type 1 Marks</div>
                        <div class="summary-value" id="type1Marks">0.00</div>
                        <div class="summary-label" id="type1Details">0✓ 0✗</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Type 2 Marks</div>
                        <div class="summary-value" id="type2Marks">0.00</div>
                        <div class="summary-label" id="type2Details">0✓ 0✗</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-label">Total Marks</div>
                        <div class="summary-value" id="totalMarks">0.00</div>
                        <div class="summary-label">Out of 100</div>
                    </div>
                </div>

                <!-- Results Grid -->
                <div class="results-grid">
                    <div class="result-card">
                        <h4><i class="fas fa-trophy"></i> Expected Rank</h4>
                        <div class="card-value" id="predictedRank">--</div>
                        <div class="card-label">All India Rank</div>
                    </div>

                    <div class="result-card">
                        <h4><i class="fas fa-star"></i> GATE Score</h4>
                        <div class="card-value" id="predictedScore">--</div>
                        <div class="card-label">Out of 1000</div>
                    </div>

                    <div class="result-card">
                        <h4><i class="fas fa-percentage"></i> Percentile</h4>
                        <div class="card-value" id="percentile">--</div>
                        <div class="card-label">Approximate</div>
                    </div>

                    <div class="result-card">
                        <h4><i class="fas fa-chart-bar"></i> Rank Range</h4>
                        <div class="card-value" id="rankRange">--</div>
                        <div class="card-label">±15% variation</div>
                    </div>
                </div>

                <!-- IIT Admission Section -->
                <div class="iit-admission" id="iitAdmissionSection">
                    <h4><i class="fas fa-university"></i> IIT Admission Chances (Based on Your Category)</h4>
                    <div id="iitGridContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- PSU Chances Section -->
                <div class="psu-section" id="psuSection">
                    <h4><i class="fas fa-building"></i> PSU Recruitment Chances</h4>
                    <div id="psuGridContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Cutoff Section -->
                <div class="cutoff-section">
                    <h4><i class="fas fa-flag-checkered"></i> GATE 2026 Expected Cutoff Marks</h4>
                    <div id="cutoffTableContainer">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Analysis Box -->
                <div class="analysis-box">
                    <h4><i class="fas fa-lightbulb"></i> Analysis & Insights</h4>
                    <div class="analysis-text" id="analysisText">
                        Enter your marks and click predict to see detailed analysis...
                    </div>
                </div>

                <!-- Graph Section -->
                <div class="graph-section">
                    <div class="graph-header">
                        <h3><i class="fas fa-chart-line"></i> Your Position on Rank Curve</h3>
                        <p>See where you stand among GATE 2025 candidates</p>
                    </div>
                    <div class="graph-container">
                        <canvas id="rankChart"></canvas>
                    </div>
                </div>

                <!-- Check Again Button -->
                <div style="text-align: center; margin-top: 30px;">
                    <button class="check-again-btn" onclick="checkAgain()">
                        <i class="fas fa-redo"></i> CHECK AGAIN WITH DIFFERENT MARKS
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <div class="footer-content">
                <h3>GATE Rank Predictor 2026</h3>
                <p>Accurate predictions with category-specific IIT admission & PSU chances analysis</p>
                <div class="copyright">
                    <i class="fas fa-copyright"></i> 2025 GATE Rank Predictor
                    <div class="developer-badge">
                        <i class="fas fa-code developer-icon"></i>
                        <span class="developer-name">Developed by RAJ BITTU</span>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // GATE 2025 Actual Data for Different Branches
        const gate2025Data = {
            "CS": [
                { rank: 1, score: 1000, marks: 100.00 },
                { rank: 4, score: 985, marks: 91.64 },
                { rank: 8, score: 976, marks: 90.75 },
                { rank: 12, score: 959, marks: 89.04 },
                { rank: 14, score: 956, marks: 88.71 },
                { rank: 32, score: 929, marks: 86.11 },
                { rank: 38, score: 922, marks: 85.43 },
                { rank: 58, score: 906, marks: 83.84 },
                { rank: 65, score: 903, marks: 83.51 },
                { rank: 130, score: 860, marks: 79.29 },
                { rank: 215, score: 833, marks: 76.69 },
                { rank: 306, score: 810, marks: 73.57 },
                { rank: 308, score: 810, marks: 74.38 },
                { rank: 336, score: 802, marks: 73.57 },
                { rank: 351, score: 797, marks: 73.16 },
                { rank: 365, score: 797, marks: 73.11 },
                { rank: 416, score: 785, marks: 71.93 },
                { rank: 532, score: 767, marks: 70.20 },
                { rank: 609, score: 757, marks: 69.21 },
                { rank: 622, score: 756, marks: 69.07 },
                { rank: 724, score: 744, marks: 67.91 },
                { rank: 1121, score: 711, marks: 64.66 },
                { rank: 1171, score: 708, marks: 64.34 },
                { rank: 1414, score: 689, marks: 62.52 },
                { rank: 1445, score: 688, marks: 62.39 },
                { rank: 1605, score: 649, marks: 58.47 },
                { rank: 2434, score: 632, marks: 56.87 },
                { rank: 2498, score: 628, marks: 56.54 },
                { rank: 3466, score: 589, marks: 52.70 },
                { rank: 4135, score: 568, marks: 50.65 },
                { rank: 5620, score: 529, marks: 46.79 },
                { rank: 6600, score: 506, marks: 44.52 },
                { rank: 9288, score: 460, marks: 40.02 },
                { rank: 11184, score: 436, marks: 37.69 },
                { rank: 11318, score: 435, marks: 37.56 },
                { rank: 11517, score: 433, marks: 37.37 },
                { rank: 12652, score: 420, marks: 36.07 },
                { rank: 14720, score: 400, marks: 34.12 },
                { rank: 18757, score: 368, marks: 31.01 },
                { rank: 19661, score: 364, marks: 30.54 },
                { rank: 23003, score: 343, marks: 28.56 }
            ],
            "EC": [
                { rank: 1, score: 1000, marks: 82.67 },
                { rank: 5, score: 980, marks: 80.00 },
                { rank: 10, score: 950, marks: 78.50 },
                { rank: 15, score: 940, marks: 77.00 },
                { rank: 40, score: 900, marks: 75.00 },
                { rank: 50, score: 890, marks: 74.00 },
                { rank: 100, score: 850, marks: 72.00 },
                { rank: 200, score: 840, marks: 70.00 },
                { rank: 500, score: 800, marks: 68.00 },
                { rank: 1000, score: 750, marks: 65.00 },
                { rank: 2000, score: 700, marks: 62.00 },
                { rank: 5000, score: 650, marks: 58.00 },
                { rank: 10000, score: 600, marks: 53.00 },
                { rank: 15000, score: 550, marks: 48.00 },
                { rank: 20000, score: 500, marks: 43.00 }
            ],
            "ME": [
                { rank: 1, score: 1000, marks: 95.00 },
                { rank: 5, score: 980, marks: 93.00 },
                { rank: 15, score: 930, marks: 90.00 },
                { rank: 50, score: 880, marks: 87.00 },
                { rank: 130, score: 830, marks: 84.00 },
                { rank: 685, score: 780, marks: 78.00 },
                { rank: 2165, score: 730, marks: 72.00 },
                { rank: 4800, score: 680, marks: 66.00 },
                { rank: 9000, score: 630, marks: 60.00 },
                { rank: 15000, score: 580, marks: 54.00 },
                { rank: 20000, score: 530, marks: 48.00 }
            ],
            "EE": [
                { rank: 1, score: 1000, marks: 81.67 },
                { rank: 5, score: 980, marks: 80.00 },
                { rank: 50, score: 940, marks: 77.00 },
                { rank: 200, score: 890, marks: 74.00 },
                { rank: 500, score: 850, marks: 72.00 },
                { rank: 1000, score: 800, marks: 69.00 },
                { rank: 5000, score: 700, marks: 62.00 },
                { rank: 10000, score: 650, marks: 58.00 },
                { rank: 15000, score: 600, marks: 53.00 },
                { rank: 20000, score: 550, marks: 48.00 }
            ],
            "CE": [
                { rank: 1, score: 1000, marks: 80.00 },
                { rank: 5, score: 980, marks: 78.00 },
                { rank: 20, score: 950, marks: 75.00 },
                { rank: 100, score: 900, marks: 72.00 },
                { rank: 700, score: 800, marks: 68.00 },
                { rank: 3000, score: 700, marks: 62.00 },
                { rank: 10000, score: 600, marks: 55.00 },
                { rank: 15000, score: 550, marks: 50.00 },
                { rank: 20000, score: 500, marks: 45.00 }
            ]
        };

        // GATE 2025 Cutoffs with 2026 projections (+1.5 marks)
        const gateCutoffs = {
            "CE": { GEN: 29.2, OBC: 26.2, EWS: 26.2, SC: 19.4, ST: 19.4, PWD: 19.4 },
            "ME": { GEN: 35.8, OBC: 32.2, EWS: 32.2, SC: 23.8, ST: 23.8, PWD: 23.8 },
            "EE": { GEN: 25.0, OBC: 22.5, EWS: 22.5, SC: 16.6, ST: 16.6, PWD: 16.6 },
            "EC": { GEN: 25.0, OBC: 22.5, EWS: 22.5, SC: 16.6, ST: 16.6, PWD: 16.6 },
            "CS": { GEN: 29.2, OBC: 26.2, EWS: 26.2, SC: 19.4, ST: 19.4, PWD: 19.4 },
            "DA": { GEN: 29.0, OBC: 23.0, EWS: 23.0, SC: 17.0, ST: 17.0, PWD: 17.0 },
            "IN": { GEN: 25.6, OBC: 31.8, EWS: 31.8, SC: 23.5, ST: 23.5, PWD: 23.5 },
            "CH": { GEN: 27.7, OBC: 24.9, EWS: 24.9, SC: 18.4, ST: 18.4, PWD: 18.4 }
        };

        // IIT Admission Marks by Category
        const iitAdmissionRanges = {
            "CS": {
                "GEN": { top: "65-70+", middle: "60-65", lower: "55-60" },
                "OBC": { top: "60-65", middle: "55-60", lower: "50-55" },
                "EWS": { top: "60-65", middle: "55-60", lower: "50-55" },
                "SC": { top: "48-53", middle: "43-48", lower: "38-43" },
                "ST": { top: "45-50", middle: "40-45", lower: "35-40" },
                "PWD": { top: "40-45", middle: "35-40", lower: "30-35" }
            },
            "EC": {
                "GEN": { top: "60-65+", middle: "55-60", lower: "50-55" },
                "OBC": { top: "55-60", middle: "50-55", lower: "45-50" },
                "EWS": { top: "55-60", middle: "50-55", lower: "45-50" },
                "SC": { top: "45-50", middle: "40-45", lower: "35-40" },
                "ST": { top: "42-47", middle: "37-42", lower: "32-37" },
                "PWD": { top: "38-43", middle: "33-38", lower: "28-33" }
            },
            "EE": {
                "GEN": { top: "58-63+", middle: "53-58", lower: "48-53" },
                "OBC": { top: "53-58", middle: "48-53", lower: "43-48" },
                "EWS": { top: "53-58", middle: "48-53", lower: "43-48" },
                "SC": { top: "43-48", middle: "38-43", lower: "33-38" },
                "ST": { top: "40-45", middle: "35-40", lower: "30-35" },
                "PWD": { top: "36-41", middle: "31-36", lower: "26-31" }
            },
            "ME": {
                "GEN": { top: "63-68+", middle: "58-63", lower: "53-58" },
                "OBC": { top: "58-63", middle: "53-58", lower: "48-53" },
                "EWS": { top: "58-63", middle: "53-58", lower: "48-53" },
                "SC": { top: "48-53", middle: "43-48", lower: "38-43" },
                "ST": { top: "45-50", middle: "40-45", lower: "35-40" },
                "PWD": { top: "40-45", middle: "35-40", lower: "30-35" }
            },
            "CE": {
                "GEN": { top: "55-60+", middle: "50-55", lower: "45-50" },
                "OBC": { top: "50-55", middle: "45-50", lower: "40-45" },
                "EWS": { top: "50-55", middle: "45-50", lower: "40-45" },
                "SC": { top: "40-45", middle: "35-40", lower: "30-35" },
                "ST": { top: "37-42", middle: "32-37", lower: "27-32" },
                "PWD": { top: "33-38", middle: "28-33", lower: "23-28" }
            }
        };

        // PSU Chances Data
        const psuChancesData = {
            "EC": [
                { marks: "82.67+", chance: "Very High", companies: "BEL, DRDO, BARC" },
                { marks: "80-82", chance: "Very High", companies: "ISRO, BHEL, GAIL" },
                { marks: "75-80", chance: "High", companies: "NTPC, PGCIL, SAIL" },
                { marks: "70-75", chance: "Moderate", companies: "ONGC, HPCL, IOCL" },
                { marks: "60-70", chance: "Moderate", companies: "Other PSUs" },
                { marks: "50-60", chance: "Low", companies: "State PSUs" },
                { marks: "<50", chance: "Unlikely", companies: "Private Sector" }
            ],
            "ME": [
                { marks: "95+", chance: "Very High", companies: "ISRO, DRDO, BHEL" },
                { marks: "90-95", chance: "Very High", companies: "NTPC, ONGC, GAIL" },
                { marks: "85-90", chance: "High", companies: "SAIL, BARC, BEL" },
                { marks: "80-85", chance: "Moderate", companies: "IOCL, HPCL, BPCL" },
                { marks: "75-80", chance: "Moderate", companies: "Other Central PSUs" },
                { marks: "70-75", chance: "Low", companies: "State PSUs" },
                { marks: "<70", chance: "Unlikely", companies: "Private Sector" }
            ],
            "EE": [
                { marks: "81.67+", chance: "Very High", companies: "PGCIL, NTPC, DRDO" },
                { marks: "80-82", chance: "Very High", companies: "BHEL, ISRO, BARC" },
                { marks: "75-80", chance: "High", companies: "ONGC, SAIL, GAIL" },
                { marks: "70-75", chance: "Moderate", companies: "BEL, HPCL, IOCL" },
                { marks: "60-70", chance: "Moderate", companies: "Other PSUs" },
                { marks: "50-60", chance: "Low", companies: "State PSUs" },
                { marks: "<50", chance: "Unlikely", companies: "Private Sector" }
            ],
            "CE": [
                { marks: "78-82", chance: "Very High", companies: "PGCIL, NHAI, CPWD" },
                { marks: "75-78", chance: "Very High", companies: "ONGC, NTPC, BHEL" },
                { marks: "70-75", chance: "High", companies: "GAIL, SAIL, ISRO" },
                { marks: "60-70", chance: "Moderate", companies: "IOCL, HPCL, BPCL" },
                { marks: "50-60", chance: "Moderate", companies: "Other PSUs" },
                { marks: "40-50", chance: "Low", companies: "State PSUs" },
                { marks: "<40", chance: "Unlikely", companies: "Private Sector" }
            ],
            "CS": [
                { marks: "85+", chance: "Very High", companies: "BEL, DRDO, ISRO" },
                { marks: "75-85", chance: "Very High", companies: "BARC, NPCIL, NTPC" },
                { marks: "65-75", chance: "High", companies: "BHEL, SAIL, GAIL" },
                { marks: "55-65", chance: "Moderate", companies: "ONGC, PGCIL, HPCL" },
                { marks: "45-55", chance: "Moderate", companies: "Other PSUs" },
                { marks: "35-45", chance: "Low", companies: "State PSUs" },
                { marks: "<35", chance: "Unlikely", companies: "Private Sector" }
            ]
        };

        const cutoffIncrease2026 = 1.5;
        let rankChart = null;
        let currentCategory = 'GEN';
        let currentPredictionData = null;

        // Select category function
        function selectCategory(category) {
            currentCategory = category;
            document.getElementById('category').value = category;
            
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateMarks();
        }

        // Set value helper
        function setValue(elementId, value) {
            const inputElement = document.getElementById(elementId);
            const otherElementId = elementId.includes('Correct') ? 
                                  elementId.replace('Correct', 'Wrong') : 
                                  elementId.replace('Wrong', 'Correct');
            const otherElement = document.getElementById(otherElementId);
            
            // Check if sum exceeds the limit
            const totalLimit = elementId.includes('type1') ? 30 : 35;
            const currentOtherValue = parseInt(otherElement.value) || 0;
            const newTotal = currentOtherValue + value;
            
            if (newTotal > totalLimit) {
                // If exceeds limit, adjust the other value
                const excess = newTotal - totalLimit;
                otherElement.value = Math.max(0, currentOtherValue - excess);
                inputElement.value = value;
            } else {
                inputElement.value = value;
            }
            
            updateMarks();
            
            const buttons = document.querySelectorAll(`[onclick*="${elementId}"]`);
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (parseInt(btn.textContent) === value) {
                    btn.classList.add('active');
                }
            });
        }

        // Update marks calculation only
        function updateMarks() {
            const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
            const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
            const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
            const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
            
            // Validate totals
            const type1Total = type1Correct + type1Wrong;
            const type2Total = type2Correct + type2Wrong;
            
            // Update total displays
            document.getElementById('type1Total').textContent = type1Total;
            document.getElementById('type2Total').textContent = type2Total;
            
            // Highlight if totals exceed limits
            if (type1Total > 30) {
                document.getElementById('type1Total').style.color = 'var(--danger)';
                document.getElementById('type1Total').style.fontWeight = 'bold';
            } else {
                document.getElementById('type1Total').style.color = '#666';
                document.getElementById('type1Total').style.fontWeight = 'normal';
            }
            
            if (type2Total > 35) {
                document.getElementById('type2Total').style.color = 'var(--danger)';
                document.getElementById('type2Total').style.fontWeight = 'bold';
            } else {
                document.getElementById('type2Total').style.color = '#666';
                document.getElementById('type2Total').style.fontWeight = 'normal';
            }
            
            // Calculate marks
            const type1Marks = type1Correct - (type1Wrong * 0.33);
            const type2Marks = (type2Correct * 2) - (type2Wrong * 0.67);
            const totalMarks = type1Marks + type2Marks;
            
            document.getElementById('type1Marks').textContent = type1Marks.toFixed(2);
            document.getElementById('type2Marks').textContent = type2Marks.toFixed(2);
            document.getElementById('totalMarks').textContent = totalMarks.toFixed(2);
            document.getElementById('type1Details').textContent = `${type1Correct}✓ ${type1Wrong}✗`;
            document.getElementById('type2Details').textContent = `${type2Correct}✓ ${type2Wrong}✗`;
            
            document.getElementById('resultsSection').classList.remove('visible');
        }

        // Create IIT Admission Grid
        function createIITAdmissionGrid(paper, category, userMarks) {
            const paperData = iitAdmissionRanges[paper] || iitAdmissionRanges["CS"];
            const ranges = paperData[category] || paperData["GEN"];
            
            const iitTypes = [
                { name: "Top IITs", desc: "IIT Bombay/Delhi/Madras", marks: ranges.top },
                { name: "Mid IITs", desc: "IIT Kanpur/Kharagpur/Roorkee", marks: ranges.middle },
                { name: "New IITs", desc: "IIT Hyderabad/Guwahati", marks: ranges.lower }
            ];
            
            let html = '<div class="iit-grid">';
            
            iitTypes.forEach(iit => {
                const marksNeeded = iit.marks.split('-')[0];
                const isPossible = userMarks >= parseInt(marksNeeded);
                
                html += `
                    <div class="iit-card" style="${isPossible ? 'border-top-color: var(--success);' : ''}">
                        <h5>${iit.name}</h5>
                        <div class="iit-marks">${iit.marks}</div>
                        <div class="iit-type">${iit.desc}</div>
                        <div style="margin-top: 10px; font-size: 0.9rem; ${isPossible ? 'color: var(--success); font-weight: 600;' : 'color: #666;'}">
                            ${isPossible ? '✅ Within your reach' : '❌ Need improvement'}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Add category-specific note
            if (category === 'SC' || category === 'ST') {
                html += `<p style="margin-top: 15px; color: #0e6251; font-size: 0.95rem; text-align: center;">
                    <i class="fas fa-info-circle"></i> <strong>Note for SC/ST:</strong> Many IITs offer admission with marks as low as 38-48 due to reservation benefits.
                </p>`;
            } else if (category === 'OBC' || category === 'EWS') {
                html += `<p style="margin-top: 15px; color: #0e6251; font-size: 0.95rem; text-align: center;">
                    <i class="fas fa-info-circle"></i> <strong>Note for OBC/EWS:</strong> Cutoffs are typically 5-10 marks lower than General category.
                </p>`;
            }
            
            return html;
        }

        // Create PSU Chances Grid
        function createPSUChancesGrid(paper, userMarks) {
            const psuData = psuChancesData[paper] || psuChancesData["CS"];
            let userChance = "Unlikely";
            let userCompanies = "Private Sector";
            
            // Find user's PSU chance
            psuData.forEach(item => {
                const marksRange = item.marks;
                if (marksRange.includes('+')) {
                    const minMark = parseFloat(marksRange.replace('+', ''));
                    if (userMarks >= minMark) {
                        userChance = item.chance;
                        userCompanies = item.companies;
                    }
                } else if (marksRange.includes('<')) {
                    const maxMark = parseFloat(marksRange.replace('<', ''));
                    if (userMarks < maxMark) {
                        userChance = item.chance;
                        userCompanies = item.companies;
                    }
                } else {
                    const [minMark, maxMark] = marksRange.split('-').map(m => parseFloat(m));
                    if (userMarks >= minMark && userMarks <= maxMark) {
                        userChance = item.chance;
                        userCompanies = item.companies;
                    }
                }
            });
            
            // Chance colors
            const chanceColors = {
                "Very High": "#27ae60",
                "High": "#3498db",
                "Moderate": "#f39c12",
                "Low": "#e74c3c",
                "Unlikely": "#95a5a6"
            };
            
            let html = '<div class="psu-grid">';
            
            psuData.forEach(item => {
                const isUserChance = item.chance === userChance;
                const color = chanceColors[item.chance] || "#95a5a6";
                
                html += `
                    <div class="psu-card" style="${isUserChance ? 'border-top-color: ' + color + '; transform: scale(1.05); box-shadow: 0 10px 25px rgba(0,0,0,0.15);' : 'border-top-color: ' + color + ';'}">
                        <h5>${item.chance}</h5>
                        <div class="psu-chance" style="color: ${color};">${item.marks}</div>
                        <div class="psu-companies">${item.companies}</div>
                        ${isUserChance ? '<div style="margin-top: 10px; color: ' + color + '; font-weight: 600;">✓ Your Range</div>' : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Add user's specific PSU chance
            html += `
                <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 10px; border: 3px solid ${chanceColors[userChance] || '#95a5a6'}; text-align: center;">
                    <h5 style="color: ${chanceColors[userChance] || '#95a5a6'}; margin-bottom: 10px;">Your PSU Recruitment Chance: <strong>${userChance}</strong></h5>
                    <p style="color: #555; margin-bottom: 10px;">Target Companies: ${userCompanies}</p>
                    <p style="color: #666; font-size: 0.9rem;"><i class="fas fa-info-circle"></i> Based on GATE 2025 PSU recruitment trends and cutoff marks</p>
                </div>
            `;
            
            return html;
        }

        // Calculate rank from marks
        function calculateRankFromMarks(marks, paper) {
            const data = gate2025Data[paper] || gate2025Data["CS"];
            const sortedData = [...data].sort((a, b) => b.marks - a.marks);
            
            if (sortedData.length === 0) return 25000;
            
            if (marks > sortedData[0].marks) return 1;
            if (marks < sortedData[sortedData.length - 1].marks) {
                const last = sortedData[sortedData.length - 1];
                const secondLast = sortedData[sortedData.length - 2] || last;
                const slope = (last.rank - secondLast.rank) / (last.marks - secondLast.marks);
                return Math.round(last.rank + (marks - last.marks) * slope);
            }
            
            for (let i = 0; i < sortedData.length - 1; i++) {
                if (marks <= sortedData[i].marks && marks >= sortedData[i + 1].marks) {
                    const lower = sortedData[i];
                    const upper = sortedData[i + 1];
                    const marksRange = lower.marks - upper.marks;
                    const rankRange = lower.rank - upper.rank;
                    const fraction = (lower.marks - marks) / marksRange;
                    return Math.round(lower.rank - (fraction * rankRange));
                }
            }
            
            return 25000;
        }

        // Calculate GATE score
        function calculateScoreFromMarks(marks, paper) {
            const data = gate2025Data[paper] || gate2025Data["CS"];
            const sortedData = [...data].sort((a, b) => b.marks - a.marks);
            
            if (sortedData.length === 0) return 300;
            
            if (marks > sortedData[0].marks) return 1000;
            if (marks < sortedData[sortedData.length - 1].marks) {
                const last = sortedData[sortedData.length - 1];
                const secondLast = sortedData[sortedData.length - 2] || last;
                const slope = (last.score - secondLast.score) / (last.marks - secondLast.marks);
                return Math.round(last.score + (marks - last.marks) * slope);
            }
            
            for (let i = 0; i < sortedData.length - 1; i++) {
                if (marks <= sortedData[i].marks && marks >= sortedData[i + 1].marks) {
                    const lower = sortedData[i];
                    const upper = sortedData[i + 1];
                    const marksRange = lower.marks - upper.marks;
                    const scoreRange = lower.score - upper.score;
                    const fraction = (lower.marks - marks) / marksRange;
                    return Math.round(lower.score - (fraction * scoreRange));
                }
            }
            
            return 300;
        }

        // Calculate percentile
        function calculatePercentile(rank, paper) {
            const paperCandidates = {
                "CS": 120000,
                "EC": 80000,
                "EE": 70000,
                "ME": 100000,
                "CE": 90000,
                "DA": 40000,
                "IN": 30000,
                "CH": 35000
            };
            
            const totalCandidates = paperCandidates[paper] || 100000;
            const percentile = ((totalCandidates - rank) / totalCandidates) * 100;
            return Math.min(99.99, Math.max(0.01, percentile.toFixed(2)));
        }

        // Get cutoff for selected paper and category
        function getCutoff(paper, category) {
            const cutoffData = gateCutoffs[paper];
            if (!cutoffData) return gateCutoffs["CS"][category] + cutoffIncrease2026;
            return cutoffData[category] + cutoffIncrease2026;
        }

        // Create cutoff table
        function createCutoffTable(paper, userMarks, userCategory) {
            const cutoffData = gateCutoffs[paper] || gateCutoffs["CS"];
            const paperNames = {
                "CE": "Civil Engineering", "ME": "Mechanical Engineering", "EE": "Electrical Engineering",
                "EC": "Electronics & Communication", "CS": "Computer Science", "DA": "Data Science & AI",
                "IN": "Instrumentation Engineering", "CH": "Chemical Engineering"
            };
            
            const categoryMap = { GEN: "General", OBC: "OBC-NCL", EWS: "EWS", SC: "SC", ST: "ST", PWD: "PwD" };
            
            let html = `
                <p><strong>Paper:</strong> ${paperNames[paper]} | <strong>Your Category:</strong> ${categoryMap[userCategory]}</p>
                <table class="cutoff-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>2025 Cutoff</th>
                            <th>Expected 2026</th>
                            <th>Your Marks</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            Object.entries(categoryMap).forEach(([code, name]) => {
                const cutoff2025 = cutoffData[code] || 0;
                const cutoff2026 = cutoff2025 + cutoffIncrease2026;
                const isUserCategory = code === userCategory;
                const passes = userMarks >= cutoff2026;
                
                html += `
                    <tr ${isUserCategory ? 'class="your-cutoff"' : ''}>
                        <td><strong>${name}</strong>${isUserCategory ? ' (You)' : ''}</td>
                        <td class="cutoff-value">${cutoff2025.toFixed(1)}</td>
                        <td class="cutoff-value">${cutoff2026.toFixed(1)} <span class="cutoff-diff cutoff-increase">+1.5</span></td>
                        <td class="cutoff-value">${isUserCategory ? userMarks.toFixed(1) : '-'}</td>
                        <td>
                `;
                
                if (isUserCategory) {
                    if (passes) {
                        html += `<span class="cutoff-diff cutoff-pass"><i class="fas fa-check"></i> PASS</span>`;
                    } else {
                        html += `<span class="cutoff-diff cutoff-fail"><i class="fas fa-times"></i> FAIL</span>`;
                    }
                } else {
                    html += `-`;
                }
                
                html += `</td></tr>`;
            });
            
            html += `</tbody></table>`;
            return html;
        }

        // Get qualification status
        function getQualificationStatus(qualified, userMarks, requiredCutoff, paper, category) {
            const categoryNames = { GEN: "General", OBC: "OBC-NCL", EWS: "EWS", SC: "SC", ST: "ST", PWD: "PwD" };
            const paperNames = {
                "CE": "Civil Engineering", "ME": "Mechanical", "EE": "Electrical",
                "EC": "Electronics", "CS": "Computer Science", "DA": "Data Science",
                "IN": "Instrumentation", "CH": "Chemical"
            };
            
            const statusDiv = document.getElementById('qualificationStatus');
            
            if (qualified) {
                statusDiv.className = 'qualification-status qualified';
                statusDiv.innerHTML = `
                    <div class="status-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="status-title" style="color: var(--success);">QUALIFIED! 🎉</div>
                    <div class="status-details">
                        <p>Congratulations! You have cleared the GATE 2026 expected cutoff for ${paperNames[paper]} (${categoryNames[category]}).</p>
                        <p><strong>Your Marks:</strong> ${userMarks.toFixed(1)} | <strong>Required Cutoff:</strong> ${requiredCutoff.toFixed(1)}</p>
                        <p>You are <strong>${(userMarks - requiredCutoff).toFixed(1)} marks above</strong> the expected cutoff.</p>
                    </div>
                `;
            } else {
                statusDiv.className = 'qualification-status not-qualified';
                statusDiv.innerHTML = `
                    <div class="status-icon"><i class="fas fa-times-circle"></i></div>
                    <div class="status-title" style="color: var(--danger);">NOT QUALIFIED 😔</div>
                    <div class="status-details">
                        <p>You need to improve your score to clear the GATE 2026 expected cutoff for ${paperNames[paper]} (${categoryNames[category]}).</p>
                        <p><strong>Your Marks:</strong> ${userMarks.toFixed(1)} | <strong>Required Cutoff:</strong> ${requiredCutoff.toFixed(1)}</p>
                        <p>You need <strong>${(requiredCutoff - userMarks).toFixed(1)} more marks</strong> to qualify.</p>
                    </div>
                `;
            }
        }

        // Get analysis text with category-specific IIT info
        function getAnalysisText(rank, marks, score, qualified, paper, category) {
            const categoryName = { GEN: "General", OBC: "OBC-NCL", EWS: "EWS", SC: "SC", ST: "ST", PWD: "PwD" }[category];
            const paperName = {
                "CE": "Civil Engineering", "ME": "Mechanical", "EE": "Electrical",
                "EC": "Electronics", "CS": "Computer Science", "DA": "Data Science",
                "IN": "Instrumentation", "CH": "Chemical"
            }[paper];
            
            let analysis = '';
            
            // Category-specific IIT information
            if (category === 'SC' || category === 'ST') {
                analysis = `<span class="good">SC/ST Category Advantage:</span> Many IITs offer admission with marks in the range of <strong>38-53</strong> for your category.<br><br>`;
            } else if (category === 'OBC' || category === 'EWS') {
                analysis = `<span class="good">OBC/EWS Category Benefit:</span> Cutoffs are typically <strong>5-10 marks lower</strong> than General category.<br><br>`;
            }
            
            if (qualified) {
                if (rank <= 100) {
                    analysis += `<span class="excellent">Excellent! With rank ${rank.toLocaleString()} in ${categoryName} category, you have excellent chances for top IITs and IISc.</span>`;
                } else if (rank <= 500) {
                    analysis += `<span class="good">Great! Rank ${rank.toLocaleString()} is very competitive. You have good chances for all IITs and excellent chances for top NITs.</span>`;
                } else if (rank <= 1000) {
                    analysis += `<span class="good">Good performance! Rank ${rank.toLocaleString()} gives you good chances for IITs and excellent chances for NITs and IIITs.</span>`;
                } else if (rank <= 3000) {
                    analysis += `<span class="average">Good score! With rank ${rank.toLocaleString()}, you have good chances for NITs, IIITs, and other good universities.</span>`;
                } else {
                    analysis += `<span class="average">You have qualified! Rank ${rank.toLocaleString()} gives you opportunities in various universities and colleges.</span>`;
                }
            } else {
                analysis += `<span class="improve">You need to improve your score to qualify. Consider focusing on weak areas and practice more.</span>`;
            }
            
            analysis += `<br><br><strong>Based on ${marks.toFixed(2)} marks in ${paperName} and GATE score ${score}:</strong><br>`;
            
            if (qualified) {
                if (rank <= 1000) {
                    analysis += "✅ High probability for IIT M.Tech admissions<br>";
                    analysis += "✅ Good chances for PSU recruitment through GATE<br>";
                    analysis += "✅ Eligible for PhD programs in top institutes<br>";
                    analysis += "✅ Can apply for research fellowships";
                } else if (rank <= 5000) {
                    analysis += "✅ Good chances for NITs and IIITs<br>";
                    analysis += "✅ Eligible for most PSUs through GATE<br>";
                    analysis += "✅ Good opportunities for higher studies<br>";
                    analysis += "✅ Can apply for junior research fellow positions";
                } else {
                    analysis += "✅ Eligible for admission in many universities<br>";
                    analysis += "✅ Some PSUs may accept this rank<br>";
                    analysis += "✅ Good foundation for further improvement<br>";
                    analysis += "✅ Can apply for assistant professor positions";
                }
            } else {
                analysis += "❌ Need to clear cutoff first<br>";
                analysis += "📚 Focus on improving weak areas<br>";
                analysis += "⏱️ Practice time management<br>";
                analysis += "📈 Aim for at least " + (getCutoff(paper, category) + 5).toFixed(1) + " marks to be safe";
            }
            
            return analysis;
        }

        // Update chart
        function updateChart(userMarks, userRank, paper) {
            const ctx = document.getElementById('rankChart').getContext('2d');
            const data = gate2025Data[paper] || gate2025Data["CS"];
            const chartData = data.filter((_, index) => index % 2 === 0);
            
            if (rankChart) {
                rankChart.destroy();
            }
            
            rankChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'GATE 2025 Actual Data',
                        data: chartData.map(d => ({x: d.rank, y: d.marks})),
                        backgroundColor: 'rgba(52, 152, 219, 0.6)',
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1,
                        pointRadius: 4
                    }, {
                        label: 'Your Position',
                        data: [{x: userRank, y: userMarks}],
                        backgroundColor: 'rgba(231, 76, 60, 1)',
                        borderColor: 'rgba(192, 57, 43, 1)',
                        borderWidth: 3,
                        pointRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `Your Position: Rank ${userRank.toLocaleString()} (${userMarks.toFixed(2)} marks)`,
                            font: {size: 16, weight: 'bold'}
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: {
                                display: true,
                                text: 'Rank (Lower is Better)',
                                font: {size: 14, weight: 'bold'}
                            },
                            reverse: true,
                            ticks: {
                                callback: value => value.toLocaleString()
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Marks (out of 100)',
                                font: {size: 14, weight: 'bold'}
                            },
                            min: 20,
                            max: 100
                        }
                    }
                }
            });
        }

        // Save result to localStorage
        function saveResult() {
            if (!currentPredictionData) {
                alert("Please generate a prediction first!");
                return;
            }
            
            const predictions = JSON.parse(localStorage.getItem('gatePredictions') || '[]');
            currentPredictionData.timestamp = new Date().toISOString();
            currentPredictionData.id = Date.now();
            predictions.push(currentPredictionData);
            
            localStorage.setItem('gatePredictions', JSON.stringify(predictions));
            
            alert("Result saved successfully! You can view saved results anytime by refreshing the page.");
        }

        // Share on WhatsApp
        function shareWhatsApp() {
            if (!currentPredictionData) {
                alert("Please generate a prediction first!");
                return;
            }
            
            const { paper, category, marks, rank, score, percentile, qualified } = currentPredictionData;
            const paperName = {
                "CE": "Civil Engineering", "ME": "Mechanical", "EE": "Electrical",
                "EC": "Electronics", "CS": "Computer Science", "DA": "Data Science",
                "IN": "Instrumentation", "CH": "Chemical"
            }[paper];
            
            const message = `📊 My GATE 2026 Prediction Results:

📝 Paper: ${paperName} (${category})
📊 Marks: ${marks.toFixed(2)}/100
🏆 Expected Rank: ${rank.toLocaleString()}
⭐ GATE Score: ${score}
📈 Percentile: ${percentile}%
✅ Qualification: ${qualified ? "PASSED ✓" : "NOT QUALIFIED ✗"}

🔗 Check your prediction at: ${window.location.href}

#GATE2026 #GATEPrediction #GATERankPredictor`;
            
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // Download as Image
        function downloadResult() {
            const resultsSection = document.getElementById('resultsSection');
            
            html2canvas(resultsSection, {
                scale: 2,
                backgroundColor: '#ffffff',
                useCORS: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `GATE-2026-Prediction-${currentPredictionData.paper}-${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        }

        // Check again function
        function checkAgain() {
            document.getElementById('resultsSection').classList.remove('visible');
            document.getElementById('loading').style.display = 'none';
            
            document.getElementById('inputSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Main prediction function
        function predictRank() {
            const type1Correct = parseInt(document.getElementById('type1Correct').value) || 0;
            const type1Wrong = parseInt(document.getElementById('type1Wrong').value) || 0;
            const type2Correct = parseInt(document.getElementById('type2Correct').value) || 0;
            const type2Wrong = parseInt(document.getElementById('type2Wrong').value) || 0;
            
            // Validate totals before proceeding
            const type1Total = type1Correct + type1Wrong;
            const type2Total = type2Correct + type2Wrong;
            
            if (type1Total > 30) {
                alert("Error: Total 1-mark questions (correct + wrong) cannot exceed 30. Please adjust your inputs.");
                return;
            }
            
            if (type2Total > 35) {
                alert("Error: Total 2-mark questions (correct + wrong) cannot exceed 35. Please adjust your inputs.");
                return;
            }
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('resultsSection').classList.remove('visible');
            
            setTimeout(() => {
                const paper = document.getElementById('paper').value;
                const category = currentCategory;
                
                const type1Marks = type1Correct - (type1Wrong * 0.33);
                const type2Marks = (type2Correct * 2) - (type2Wrong * 0.67);
                const userMarks = type1Marks + type2Marks;
                
                const predictedRank = calculateRankFromMarks(userMarks, paper);
                const predictedScore = calculateScoreFromMarks(userMarks, paper);
                const percentile = calculatePercentile(predictedRank, paper);
                const rankLower = Math.max(1, Math.round(predictedRank * 0.85));
                const rankUpper = Math.round(predictedRank * 1.15);
                
                const requiredCutoff = getCutoff(paper, category);
                const qualified = userMarks >= requiredCutoff;
                
                // Store prediction data
                currentPredictionData = {
                    paper,
                    category,
                    marks: userMarks,
                    rank: predictedRank,
                    score: predictedScore,
                    percentile,
                    qualified,
                    type1Correct,
                    type1Wrong,
                    type2Correct,
                    type2Wrong
                };
                
                document.getElementById('type1Marks').textContent = type1Marks.toFixed(2);
                document.getElementById('type2Marks').textContent = type2Marks.toFixed(2);
                document.getElementById('totalMarks').textContent = userMarks.toFixed(2);
                document.getElementById('type1Details').textContent = `${type1Correct}✓ ${type1Wrong}✗`;
                document.getElementById('type2Details').textContent = `${type2Correct}✓ ${type2Wrong}✗`;
                
                document.getElementById('predictedRank').textContent = predictedRank.toLocaleString();
                document.getElementById('predictedScore').textContent = predictedScore;
                document.getElementById('percentile').textContent = percentile + '%';
                document.getElementById('rankRange').textContent = `${rankLower.toLocaleString()} - ${rankUpper.toLocaleString()}`;
                
                getQualificationStatus(qualified, userMarks, requiredCutoff, paper, category);
                
                document.getElementById('cutoffTableContainer').innerHTML = createCutoffTable(paper, userMarks, category);
                
                document.getElementById('iitGridContainer').innerHTML = createIITAdmissionGrid(paper, category, userMarks);
                
                document.getElementById('psuGridContainer').innerHTML = createPSUChancesGrid(paper, userMarks);
                
                document.getElementById('analysisText').innerHTML = getAnalysisText(predictedRank, userMarks, predictedScore, qualified, paper, category);
                
                updateChart(userMarks, predictedRank, paper);
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('resultsSection').classList.add('visible');
                
                document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            }, 1000);
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', function() {
            // Set initial values within limits
            document.getElementById('type1Correct').setAttribute('max', 30);
            document.getElementById('type1Wrong').setAttribute('max', 30);
            document.getElementById('type2Correct').setAttribute('max', 35);
            document.getElementById('type2Wrong').setAttribute('max', 35);
            
            setValue('type1Correct', 20);
            setValue('type1Wrong', 3);
            setValue('type2Correct', 15);
            setValue('type2Wrong', 2);
            
            updateMarks();
            document.getElementById('resultsSection').classList.remove('visible');
            
            // Check for saved predictions
            const savedPredictions = localStorage.getItem('gatePredictions');
            if (savedPredictions) {
                console.log("Saved predictions found:", JSON.parse(savedPredictions).length);
            }
        });
    </script>
</body>
</html>
